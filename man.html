<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to create a package, the fundamental unit of shareable, reusable, and reproducible R code.">
<title>16&nbsp; Function documentation – R Packages (2e)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./vignettes.html" rel="next">
<link href="./testing-advanced.html" rel="prev">
<link href="./images/cover-2e-small.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8c563c05ac8c1d64e78fdaf2b4701079.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r-pkgs.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./man.html">Documentation</a></li><li class="breadcrumb-item"><a href="./man.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Packages (2e)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hadley/r-pkgs/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Whole Game</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">System setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow101.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./package-within.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The package within</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Package components</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Other components</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Package metadata</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><code>DESCRIPTION</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-mindset-background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dependencies: Mindset and Background</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-in-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dependencies: In Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Licensing</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Testing basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Designing your test suite</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Advanced testing techniques</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./man.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vignettes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vignettes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Other markdown files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Website</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Maintenance and distribution</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software-development-practices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Software development practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lifecycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Lifecycle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./release.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Releasing to CRAN</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-CMD-check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#roxygen2-basics" id="toc-roxygen2-basics" class="nav-link active" data-scroll-target="#roxygen2-basics"><span class="header-section-number">16.1</span> roxygen2 basics</a>
  <ul class="collapse">
<li><a href="#sec-man-workflow" id="toc-sec-man-workflow" class="nav-link" data-scroll-target="#sec-man-workflow"><span class="header-section-number">16.1.1</span> The documentation workflow</a></li>
  <li><a href="#sec-man-roxygen-comments" id="toc-sec-man-roxygen-comments" class="nav-link" data-scroll-target="#sec-man-roxygen-comments"><span class="header-section-number">16.1.2</span> roxygen2 comments, blocks, and tags</a></li>
  <li><a href="#sec-man-key-md-features" id="toc-sec-man-key-md-features" class="nav-link" data-scroll-target="#sec-man-key-md-features"><span class="header-section-number">16.1.3</span> Key markdown features</a></li>
  </ul>
</li>
  <li>
<a href="#title-description-details" id="toc-title-description-details" class="nav-link" data-scroll-target="#title-description-details"><span class="header-section-number">16.2</span> Title, description, details</a>
  <ul class="collapse">
<li><a href="#title" id="toc-title" class="nav-link" data-scroll-target="#title"><span class="header-section-number">16.2.1</span> Title</a></li>
  <li><a href="#description" id="toc-description" class="nav-link" data-scroll-target="#description"><span class="header-section-number">16.2.2</span> Description</a></li>
  <li><a href="#details" id="toc-details" class="nav-link" data-scroll-target="#details"><span class="header-section-number">16.2.3</span> Details</a></li>
  </ul>
</li>
  <li>
<a href="#arguments" id="toc-arguments" class="nav-link" data-scroll-target="#arguments"><span class="header-section-number">16.3</span> Arguments</a>
  <ul class="collapse">
<li><a href="#multiple-arguments" id="toc-multiple-arguments" class="nav-link" data-scroll-target="#multiple-arguments"><span class="header-section-number">16.3.1</span> Multiple arguments</a></li>
  <li><a href="#inheriting-arguments" id="toc-inheriting-arguments" class="nav-link" data-scroll-target="#inheriting-arguments"><span class="header-section-number">16.3.2</span> Inheriting arguments</a></li>
  </ul>
</li>
  <li><a href="#sec-man-returns" id="toc-sec-man-returns" class="nav-link" data-scroll-target="#sec-man-returns"><span class="header-section-number">16.4</span> Return value</a></li>
  <li>
<a href="#sec-man-examples" id="toc-sec-man-examples" class="nav-link" data-scroll-target="#sec-man-examples"><span class="header-section-number">16.5</span> Examples</a>
  <ul class="collapse">
<li><a href="#contents" id="toc-contents" class="nav-link" data-scroll-target="#contents"><span class="header-section-number">16.5.1</span> Contents</a></li>
  <li><a href="#leave-the-world-as-you-found-it" id="toc-leave-the-world-as-you-found-it" class="nav-link" data-scroll-target="#leave-the-world-as-you-found-it"><span class="header-section-number">16.5.2</span> Leave the world as you found it</a></li>
  <li><a href="#sec-man-examples-errors" id="toc-sec-man-examples-errors" class="nav-link" data-scroll-target="#sec-man-examples-errors"><span class="header-section-number">16.5.3</span> Errors</a></li>
  <li><a href="#sec-man-examples-dependencies-conditional-execution" id="toc-sec-man-examples-dependencies-conditional-execution" class="nav-link" data-scroll-target="#sec-man-examples-dependencies-conditional-execution"><span class="header-section-number">16.5.4</span> Dependencies and conditional execution</a></li>
  <li><a href="#intermixing-examples-and-text" id="toc-intermixing-examples-and-text" class="nav-link" data-scroll-target="#intermixing-examples-and-text"><span class="header-section-number">16.5.5</span> Intermixing examples and text</a></li>
  </ul>
</li>
  <li>
<a href="#re-using-documentation" id="toc-re-using-documentation" class="nav-link" data-scroll-target="#re-using-documentation"><span class="header-section-number">16.6</span> Re-using documentation</a>
  <ul class="collapse">
<li><a href="#sec-man-multiple-functions" id="toc-sec-man-multiple-functions" class="nav-link" data-scroll-target="#sec-man-multiple-functions"><span class="header-section-number">16.6.1</span> Multiple functions in one topic</a></li>
  <li><a href="#inheriting-documentation" id="toc-inheriting-documentation" class="nav-link" data-scroll-target="#inheriting-documentation"><span class="header-section-number">16.6.2</span> Inheriting documentation</a></li>
  <li><a href="#child-documents" id="toc-child-documents" class="nav-link" data-scroll-target="#child-documents"><span class="header-section-number">16.6.3</span> Child documents</a></li>
  </ul>
</li>
  <li><a href="#sec-man-package-doc" id="toc-sec-man-package-doc" class="nav-link" data-scroll-target="#sec-man-package-doc"><span class="header-section-number">16.7</span> Help topic for the package</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/man.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./man.html">Documentation</a></li><li class="breadcrumb-item"><a href="./man.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-man" class="quarto-section-identifier"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this chapter, you’ll learn about function documentation, which users access with <code>?somefunction</code> or <code>help("somefunction")</code>. Base R provides a standard way of documenting a package where each function is documented in a <strong>topic,</strong> an <code>.Rd</code> file (“R documentation”) in the <code>man/</code> directory. <code>.Rd</code> files use a custom syntax, loosely based on LaTeX, and can be rendered to HTML, plain text, or pdf, as needed, for viewing in different contexts.</p>
<p>In the devtools ecosystem, we don’t edit <code>.Rd</code> files directly with our bare hands. Instead, we include specially formatted “roxygen comments” above the source code for each function<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Then we use the <a href="https://roxygen2.r-lib.org/index.html">roxygen2 package</a> to generate the <code>.Rd</code> files from these special comments<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> . There are a few advantages to using roxygen2 :</p>
<ul>
<li><p>Code and documentation are co-located. When you modify your code, it’s easy to remember to also update your documentation.</p></li>
<li><p>You can use markdown, rather than having to learn a one-off markup language that only applies to <code>.Rd</code> files. In addition to formatting, the automatic hyperlinking functionality makes it much, much easier to create richly linked documentation.</p></li>
<li><p>There’s a lot of <code>.Rd</code> boilerplate that’s automated away.</p></li>
<li><p>roxygen2 provides a number of tools for sharing content across documentation topics and even between topics and vignettes.</p></li>
</ul>
<p>In this chapter we’ll focus on documenting functions, but the same ideas apply to documenting datasets (<a href="data.html#sec-documenting-data" class="quarto-xref"><span>Section 7.1.2</span></a>), classes and generics, and packages. You can learn more about those important topics in <code><a href="https://roxygen2.r-lib.org/articles/rd-other.html">vignette("rd-other", package = "roxygen2")</a></code>.</p>
<section id="roxygen2-basics" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="roxygen2-basics">
<span class="header-section-number">16.1</span> roxygen2 basics</h2>
<p>To get started, we’ll work through the basic roxygen2 workflow and discuss the overall structure of roxygen2 comments, which are organised into blocks and tags. We also highlight the biggest wins of using markdown with roxygen2.</p>
<section id="sec-man-workflow" class="level3" data-number="16.1.1"><h3 data-number="16.1.1" class="anchored" data-anchor-id="sec-man-workflow">
<span class="header-section-number">16.1.1</span> The documentation workflow</h3>
<p>Unlike with testthat, there’s no obvious opening move to declare that you’re going to use roxygen2 for documentation. That’s because the use of roxygen2 is purely a matter of your development workflow. It has no effect on, e.g., how a package gets checked or built. We think the roxygen approach is the best way to generate your <code>.Rd</code> files, but officially R only cares about the files themselves, not how they came to be.</p>
<p>Your documentation workflow truly begins when you start to add roxygen comments above your functions. Roxygen comment lines always start with <code>#'</code> , the usual <code>#</code> for a comment, followed immediately by a single quote <code>'</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Add together two numbers</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @param x A number.</span></span>
<span><span class="co">#' @param y A number.</span></span>
<span><span class="co">#' @returns A numeric vector.</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' add(1, 1)</span></span>
<span><span class="co">#' add(10, 1)</span></span>
<span><span class="va">add</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>Usually you write your function first, then its documentation. Once the function definition exists, put your cursor somewhere in it and do <em>Code &gt; Insert Roxygen Skeleton</em> to get a great head start on the roxygen comment.</p>
</div>
</div>
<p>Once you have at least one roxygen comment, run <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> to generate (or update) your package’s <code>.Rd</code> files<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Under the hood, this ultimately calls <code><a href="https://roxygen2.r-lib.org/reference/roxygenize.html">roxygen2::roxygenise()</a></code>. The roxygen block above generates a <code>man/add.Rd</code> file that looks like this:</p>
<pre class="text"><code>% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add.R
\name{add}
\alias{add}
\title{Add together two numbers}
\usage{
add(x, y)
}
\arguments{
\item{x}{A number.}

\item{y}{A number.}
}
\value{
A numeric vector.
}
\description{
Add together two numbers
}
\examples{
add(1, 1)
add(10, 1)
}</code></pre>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can also run <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> with the keyboard shortcut Ctrl/Cmd + Shift + D or via the <em>Build</em> menu or pane.</p>
</div>
</div>
<p>If you’ve used LaTeX before, this should look vaguely familiar since the <code>.Rd</code> format is loosely based on LaTeX. If you are interested in the <code>.Rd</code> format, you can read more in <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Rd-format">Writing R Extensions</a>. But generally you’ll never need to look at <code>.Rd</code> files, except to commit them to your package’s Git repository.</p>
<p>How does this <code>.Rd</code> file correspond to the documentation you see in R? When you run <code>?add</code>, <code>help("add")</code>, or <code>example("add")</code>, R looks for an <code>.Rd</code> file containing <code>\alias{add}</code>. It then parses the file, converts it into HTML, and displays it. <a href="#fig-rendered-help-topic-add" class="quarto-xref">Figure&nbsp;<span>16.1</span></a> shows how this help topic would look in RStudio:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-rendered-help-topic-add" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of the help topic for the add() function.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-rendered-help-topic-add-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/man-add.png" class="img-fluid figure-img" alt="Screenshot of the help topic for the add() function.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rendered-help-topic-add-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Help topic rendered to HTML.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>R CMD check</code> warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>You should document all exported functions and datasets. Otherwise, you’ll get this warning from <code>R CMD check</code>:</p>
<pre><code>W  checking for missing documentation entries (614ms)
  Undocumented code objects:
    ‘somefunction’
  Undocumented data sets:
    ‘somedata’
  All user-level objects in a package should have documentation entries.</code></pre>
<p>Conversely, you probably don’t want to document unexported functions. If you want to use roxygen comments for internal documentation, include the <code>@noRd</code> tag to suppress the creation of the <code>.Rd</code> file.</p>
</div>
</div>
<p>This is also a good time to explain something you may have noticed in your <code>DESCRIPTION</code> file:</p>
<pre><code>Roxygen: list(markdown = TRUE)</code></pre>
<p>devtools/usethis includes this by default when initiating a <code>DESCRIPTION</code> file and it gives roxygen2 a heads-up that your package uses markdown syntax in its roxygen comments.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>The default help-seeking process looks inside <strong>installed</strong> packages, so to see your package’s documentation during development, devtools overrides the usual help functions with modified versions that know to consult the current <strong>source</strong> package. To activate these overrides, you’ll need to run <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code> at least once. If it feels like your edits to the roxygen comments aren’t having an effect, double check that you have actually regenerated the <code>.Rd</code> files with <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> and that you’ve loaded your package. When you call <code>?function</code>, you should see “Rendering development documentation …”.</p>
<p>To summarize, there are four steps in the basic roxygen2 workflow:</p>
<ol type="1">
<li><p>Add roxygen2 comments to your <code>.R</code> files.</p></li>
<li><p>Run <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> or press Ctrl/Cmd + Shift + D to convert roxygen2 comments to <code>.Rd</code> files.</p></li>
<li><p>Preview documentation with <code>?function</code>.</p></li>
<li><p>Rinse and repeat until the documentation looks the way you want.</p></li>
</ol></section><section id="sec-man-roxygen-comments" class="level3" data-number="16.1.2"><h3 data-number="16.1.2" class="anchored" data-anchor-id="sec-man-roxygen-comments">
<span class="header-section-number">16.1.2</span> roxygen2 comments, blocks, and tags</h3>
<p>Now that you understand the basic workflow, we’ll go into more detail about the syntax. roxygen2 comments start with <code>#'</code> and all the roxygen2 comments preceding a function are collectively called a <strong>block</strong>. Blocks are broken up by <strong>tags</strong>, which look like <code>@tagName tagValue</code>, and the content of a tag extends from the end of the tag name to the start of the next tag<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. A block can contain text before the first tag which is called the <strong>introduction</strong>. By default, each block generates a single documentation <strong>topic</strong>, i.e.&nbsp;a single <code>.Rd</code> file<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> in the <code>man/</code> directory .</p>
<p>Throughout this chapter we’ll show you roxygen2 comments from real tidyverse packages, focusing on <a href="https://stringr.tidyverse.org">stringr</a>, since the functions there tend to be fairly straightforward, leading to documentation that’s understandable with relatively little context. We attach stringr here so that its functions are hyperlinked in the rendered book (more on that in section <a href="#sec-man-key-md-features" class="quarto-xref"><span>Section 16.1.3</span></a>).</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s a simple first example: the documentation for <code><a href="https://stringr.tidyverse.org/reference/str_unique.html">str_unique()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Remove duplicated strings</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' `str_unique()` removes duplicated values, with optional control over</span></span>
<span><span class="co">#' how duplication is measured.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param string Input vector. Either a character vector, or something</span></span>
<span><span class="co">#'  coercible to one.</span></span>
<span><span class="co">#' @param ... Other options used to control matching behavior between duplicate</span></span>
<span><span class="co">#'   strings. Passed on to [stringi::stri_opts_collator()].</span></span>
<span><span class="co">#' @returns A character vector, usually shorter than `string`.</span></span>
<span><span class="co">#' @seealso [unique()], [stringi::stri_unique()] which this function wraps.</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' str_unique(c("a", "b", "c", "b", "a"))</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Use ... to pass additional arguments to stri_unique()</span></span>
<span><span class="co">#' str_unique(c("motley", "mötley", "pinguino", "pingüino"))</span></span>
<span><span class="co">#' str_unique(c("motley", "mötley", "pinguino", "pingüino"), strength = 1)</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">str_unique</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">string</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">...</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here the introduction includes the title (“Remove duplicated strings”) and a basic description of what the function does. The introduction is followed by five tags: two <code>@param</code>s, one <code>@returns</code>, one <code>@seealso</code>, one <code>@examples</code>, and one <code>@export</code>.</p>
<p>Note that the block has an intentional line length (typically the same as that used for the surrounding R code) and the second and subsequent lines of the long <code>@param</code> tag are indented, which makes the entire block easier to scan. You can get more roxygen2 style advice in the <a href="https://style.tidyverse.org/documentation.html">tidyverse style guide</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>It can be aggravating to manually manage the line length of roxygen comments, so be sure to try out <em>Code &gt; Reflow Comment</em> (Ctrl/Cmd+Shift+/).</p>
</div>
</div>
<p>Note also that the order in which tags appear in your roxygen comments (or even in handwritten <code>.Rd</code> files) does not dictate the order in rendered documentation. The order of presentation is determined by tooling within base R.</p>
<p>The following sections go into more depth for the most important tags. We start with the introduction, which provides the title, description, and details. Then we cover the inputs (the function arguments), outputs (the return value), and examples. Next we discuss links and cross-references, then finish off with techniques for sharing documentation between topics.</p>
</section><section id="sec-man-key-md-features" class="level3" data-number="16.1.3"><h3 data-number="16.1.3" class="anchored" data-anchor-id="sec-man-key-md-features">
<span class="header-section-number">16.1.3</span> Key markdown features</h3>
<p>For the most part, general markdown and R Markdown knowledge suffice for taking advantage of markdown in roxygen2. But there are a few pieces of syntax that are so important we want to highlight them here. You’ll see these in many of the examples in this chapter.</p>
<p><strong>Backticks for inline code</strong>: Use backticks to format a piece of text as code, i.e.&nbsp;in a fixed width font. Example:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' I like `thisfunction()`, because it's great.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Square brackets for an auto-linked function</strong>: Enclose text like <code>somefunction()</code> and <code>somepackage::somefunction()</code> in square brackets to get an automatic link to that function’s documentation. Be sure to include the trailing parentheses, because it’s good style and and it causes the function to be formatted as code, i.e.&nbsp;you don’t need to add backticks. Example:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' It's obvious that `thisfunction()` is better than [otherpkg::otherfunction()]</span></span>
<span><span class="co">#' or even our own [olderfunction()].</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Vignettes</strong>: If you refer to a vignette with an inline call to <code>vignette("some-topic")</code>, it serves a dual purpose. First, this is literally the R code you would execute to view a vignette locally. But wait there’s more! In many rendered contexts, this automatically becomes a hyperlink to that same vignette in a pkgdown website. Here we use that to link to some very relevant vignettes<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>:</p>
<ul>
<li><p><code><a href="https://roxygen2.r-lib.org/articles/rd-formatting.html">vignette("rd-formatting", package = "roxygen2")</a></code></p></li>
<li><p><code><a href="https://roxygen2.r-lib.org/articles/reuse.html">vignette("reuse", package = "roxygen2")</a></code></p></li>
<li><p><code><a href="https://pkgdown.r-lib.org/articles/linking.html">vignette("linking", package = "pkgdown")</a></code></p></li>
</ul>
<p><strong>Lists</strong>: Bullet lists break up the dreaded “wall of text” and can make your documentation easier to scan. You can use them in the description of the function or of an argument and also for the return value. It is not necessary to include a blank line before the list, but that is also allowed.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Best features of `thisfunction()`:</span></span>
<span><span class="co">#' * Smells nice</span></span>
<span><span class="co">#' * Has good vibes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="title-description-details" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="title-description-details">
<span class="header-section-number">16.2</span> Title, description, details</h2>
<p>The introduction provides a title, description, and, optionally, details, for the function. While it’s possible to use explicit tags in the introduction, we usually rely on implicit tags when possible:</p>
<ul>
<li><p>The <strong>title</strong> is taken from the first sentence. It should be written in sentence case, not end in a full stop, and be followed by a blank line. The title is shown in various function indexes (e.g.&nbsp;<code><a href="https://rdrr.io/pkg/somepackage/man">help(package = "somepackage")</a></code>) and is what the user will usually see when browsing multiple functions.</p></li>
<li><p>The <strong>description</strong> is taken from the next paragraph. It’s shown at the top of documentation and should briefly describe the most important features of the function.</p></li>
<li><p>Additional <strong>details</strong> are anything after the description. Details are optional, but can be any length so are useful if you want to dig deep into some important aspect of the function. Note that, even though the details come right after the description in the introduction, they appear much later in rendered documentation.</p></li>
</ul>
<p>The following sections describe each component in more detail, and then discuss a few useful related tags.</p>
<section id="title" class="level3" data-number="16.2.1"><h3 data-number="16.2.1" class="anchored" data-anchor-id="title">
<span class="header-section-number">16.2.1</span> Title</h3>
<p>When writing the title, it’s useful to think about how it will appear in the reference index. When a user skims the index, how will they know which functions will solve their current problem? This requires thinking about what your functions have in common (which doesn’t need to be repeated in every title) and what is unique to that function (which should be highlighted in the title).</p>
<p>When we wrote this chapter, we found the function titles for stringr to be somewhat disappointing. But they provide a useful negative case study:</p>
<ul>
<li>
<code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code>: Detect the presence or absence of a pattern in a string</li>
<li>
<code><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract()</a></code>: Extract matching patterns from a string</li>
<li>
<code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate()</a></code>: Locate the position of patterns in a string</li>
<li>
<code><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match()</a></code>: Extract matched groups from a string</li>
</ul>
<p>There’s a lot of repetition (“pattern”, “from a string”) and the verb used for the function name is repeated in the title, so if you don’t understand the function already, the title seems unlikely to help much. Hopefully we’ll have improved those titles by the time you read this!</p>
<p>In contrast, these titles from dplyr are much better<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>:</p>
<ul>
<li>
<code>mutate()</code>: Create, modify, and delete columns</li>
<li>
<code>summarise()</code>: Summarise each group down to one row</li>
<li>
<code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>: Keep rows that match a condition</li>
<li>
<code>select()</code>: Keep or drop columns using their names and types</li>
<li>
<code>arrange()</code>: Order rows using column values</li>
</ul>
<p>Here we try to succinctly describe what the function does, making sure to describe whether it affects rows, columns, or groups. We do our best to use synonyms, instead of repeating the function name, to hopefully give folks another chance to understand the intent of the function.</p>
</section><section id="description" class="level3" data-number="16.2.2"><h3 data-number="16.2.2" class="anchored" data-anchor-id="description">
<span class="header-section-number">16.2.2</span> Description</h3>
<p>The purpose of the description is to summarize the goal of the function, usually in a single paragraph. This can be challenging for simple functions, because it can feel like you’re just repeating the title of the function. Try to find a slightly different wording, if you can. It’s okay if this feels a little repetitive; it’s often useful for users to see the same thing expressed in two different ways. It’s a little extra work, but the extra effort is often worth it. Here’s the description for <code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Detect the presence/absence of a match</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' `str_detect()` returns a logical vector with `TRUE` for each element of</span></span>
<span><span class="co">#' `string` that matches `pattern` and `FALSE` otherwise. It's equivalent to</span></span>
<span><span class="co">#' `grepl(pattern, string)`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you want more than one paragraph, you must use an explicit <code>@description</code> tag to prevent the second (and subsequent) paragraphs from being turned into the <code>@details</code>. Here’s a two-paragraph <code>@description</code> from <code><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' View strings and matches</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' `str_view()` is used to print the underlying representation of a string and</span></span>
<span><span class="co">#' to see how a `pattern` matches.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Matches are surrounded by `&lt;&gt;` and unusual whitespace (i.e. all whitespace</span></span>
<span><span class="co">#' apart from `" "` and `"\n"`) are surrounded by `{}` and escaped. Where</span></span>
<span><span class="co">#' possible, matches and unusual whitespace are coloured blue and `NA`s red.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s another example from <code><a href="https://stringr.tidyverse.org/reference/str_like.html">str_like()</a></code>, which has a bullet list in <code>@description</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Detect a pattern in the same way as `SQL`'s `LIKE` operator</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' `str_like()` follows the conventions of the SQL `LIKE` operator:</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' * Must match the entire string.</span></span>
<span><span class="co">#' * `_` matches a single character (like `.`).</span></span>
<span><span class="co">#' * `%` matches any number of characters (like `.*`).</span></span>
<span><span class="co">#' * `\%` and `\_` match literal `%` and `_`.</span></span>
<span><span class="co">#' * The match is case insensitive by default.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Basically, if you’re going to include an empty line in your description, you’ll need to use an explicit <code>@description</code> tag.</p>
<p>Finally, it’s often particularly hard to write a good description if you’ve just written the function, because the purpose often seems very obvious. Do your best, and then come back later, when you’ve forgotten exactly what the function does. Once you’ve re-derived what the function does, you’ll be able to write a better description.</p>
</section><section id="details" class="level3" data-number="16.2.3"><h3 data-number="16.2.3" class="anchored" data-anchor-id="details">
<span class="header-section-number">16.2.3</span> Details</h3>
<p>The <code>@details</code> are just any additional details or explanation that you think your function needs. Most functions don’t need details, but some functions need a lot. If you have a lot of information to convey, it’s a good idea to use informative markdown headings to break the details up into manageable sections<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>. Here’s an example from <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code>. We’ve elided some of the details to keep this example short, but you should still get a sense of how we used headings to break up the content in to skimmable chunks:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Create, modify, and delete columns</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' `mutate()` creates new columns that are functions of existing variables.</span></span>
<span><span class="co">#' It can also modify (if the name is the same as an existing</span></span>
<span><span class="co">#' column) and delete columns (by setting their value to `NULL`).</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @section Useful mutate functions:</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' * [`+`], [`-`], [log()], etc., for their usual mathematical meanings</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' ...</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @section Grouped tibbles:</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Because mutating expressions are computed within groups, they may</span></span>
<span><span class="co">#' yield different results on grouped tibbles. This will be the case</span></span>
<span><span class="co">#' as soon as an aggregating, lagging, or ranking function is</span></span>
<span><span class="co">#' involved. Compare this ungrouped mutate:</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is a good time to remind ourselves that, even though a heading like <code>Useful mutate functions</code> in the example above comes immediately after the description in the roxygen block, the content appears much later in the rendered documentation. The details (whether they use section headings or not) appear after the function usage, arguments, and return value.</p>
</section></section><section id="arguments" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="arguments">
<span class="header-section-number">16.3</span> Arguments</h2>
<p>For most functions, the bulk of your work will go towards documenting how each argument affects the output of the function. For this purpose, you’ll use <code>@param</code> (short for parameter, a synonym of argument) followed by the argument name and a description of its action.</p>
<p>The highest priority is to provide a succinct summary of the allowed inputs and what the parameter does. For example, here’s how <code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code> documents <code>string</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param string Input vector. Either a character vector, or something</span></span>
<span><span class="co">#'  coercible to one.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And here are three of the arguments to <code><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param collapse String to insert between each piece. Defaults to `""`.</span></span>
<span><span class="co">#' @param last Optional string to use in place of the final separator.</span></span>
<span><span class="co">#' @param na.rm Remove missing values? If `FALSE` (the default), the result </span></span>
<span><span class="co">#'   will be `NA` if any element of `string` is `NA`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <code>@param collapse</code> and <code>@param na.rm</code> describe their default arguments. This is often a good practice because the function usage (which shows the default values) and the argument description are often quite far apart in the rendered documentation. But there are downsides. The main one is that this duplication means you’ll need to make updates in two places if you change the default value; we believe this small amount of extra work is worth it to make the life of the user easier.</p>
<p>If an argument has a fixed set of possible parameters, you should list them. If they’re simple, you can just list them in a sentence, like in <code><a href="https://stringr.tidyverse.org/reference/str_trim.html">str_trim()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param side Side on which to remove whitespace: `"left"`, `"right"`, or</span></span>
<span><span class="co">#'   `"both"` (the default).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If they need more explanation, you might use a bulleted list, as in <code><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param whitespace_only A boolean.</span></span>
<span><span class="co">#'   * `TRUE` (the default): wrapping will only occur at whitespace.</span></span>
<span><span class="co">#'   * `FALSE`: can break on any non-word character (e.g. `/`, `-`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The documentation for most arguments will be relatively short, often one or two sentences. But you should take as much space as you need, and you’ll see some examples of multi-paragraph argument docs shortly.</p>
<section id="multiple-arguments" class="level3" data-number="16.3.1"><h3 data-number="16.3.1" class="anchored" data-anchor-id="multiple-arguments">
<span class="header-section-number">16.3.1</span> Multiple arguments</h3>
<p>If the behavior of multiple arguments is tightly coupled, you can document them together by separating the names with commas (with no spaces). For example, <code>x</code> and <code>y</code> are interchangeable in <code><a href="https://stringr.tidyverse.org/reference/str_equal.html">str_equal()</a></code>, so they’re documented together:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param x,y A pair of character vectors.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code>, <code>start</code> and <code>end</code> define the range of characters to replace. But instead of supplying both, you can use just <code>start</code> if you pass in a two-column matrix. So it makes sense to document them together:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param start,end A pair of integer vectors defining the range of characters</span></span>
<span><span class="co">#'   to extract (inclusive).</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#'   Alternatively, instead of a pair of vectors, you can pass a matrix to</span></span>
<span><span class="co">#'   `start`. The matrix should have two columns, either labelled `start`</span></span>
<span><span class="co">#'   and `end`, or `start` and `length`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <code><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap()</a></code>, <code>indent</code> and <code>exdent</code> define the indentation for the first line and all subsequent lines, respectively:</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param indent,exdent A non-negative integer giving the indent for the</span></span>
<span><span class="co">#'   first line (`indent`) and all subsequent lines (`exdent`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="inheriting-arguments" class="level3" data-number="16.3.2"><h3 data-number="16.3.2" class="anchored" data-anchor-id="inheriting-arguments">
<span class="header-section-number">16.3.2</span> Inheriting arguments</h3>
<p>If your package contains many closely related functions, it’s common for them to have arguments that share the same name and meaning. It would be both annoying and error prone to copy and paste the same <code>@param</code> documentation to every function, so roxygen2 provides <code>@inheritParams</code> which allows you to inherit argument documentation from another function, possibly even in another package.</p>
<p>stringr uses <code>@inheritParams</code> extensively because most functions have <code>string</code> and <code>pattern</code> arguments. The detailed and definitive documentation belongs to <code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param string Input vector. Either a character vector, or something</span></span>
<span><span class="co">#'  coercible to one.</span></span>
<span><span class="co">#' @param pattern Pattern to look for.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#'   The default interpretation is a regular expression, as described in</span></span>
<span><span class="co">#'   `vignette("regular-expressions")`. Use [regex()] for finer control of the</span></span>
<span><span class="co">#'   matching behaviour.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#'   Match a fixed string (i.e. by comparing only bytes), using</span></span>
<span><span class="co">#'   [fixed()]. This is fast, but approximate. Generally,</span></span>
<span><span class="co">#'   for matching human text, you'll want [coll()] which</span></span>
<span><span class="co">#'   respects character matching rules for the specified locale.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#'   Match character, word, line and sentence boundaries with</span></span>
<span><span class="co">#'   [boundary()]. An empty pattern, "", is equivalent to</span></span>
<span><span class="co">#'   `boundary("character")`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then the other stringr functions use <code>@inheritParams str_detect</code> to get this detailed documentation for <code>string</code> and <code>pattern</code> without having to duplicate that text.</p>
<p><code>@inheritParams</code> only inherits docs for arguments that the function actually uses and that aren’t already documented, so you can document some arguments locally and inherit others. <code><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match()</a></code> uses this to inherit <code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code>’s standard documentation for the <code>string</code> argument, while providing its own specialized documentation for <code>pattern</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @inheritParams str_detect</span></span>
<span><span class="co">#' @param pattern Unlike other stringr functions, `str_match()` only supports</span></span>
<span><span class="co">#'   regular expressions, as described `vignette("regular-expressions")`. </span></span>
<span><span class="co">#'   The pattern should contain at least one capturing group.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we’ve discussed default values and inheritance we can bring up one more dilemma. Sometimes there’s tension between giving detailed information on an argument (acceptable values, default value, how the argument is used, etc.) and making the documentation amenable to reuse in other functions (which might differ in some specifics). This can motivate you to assess whether it’s truly worth it for related functions to handle the same input in different ways or if standardization would be beneficial.</p>
<p>You can inherit documentation from a function in another package by using the standard <code>::</code> notation, i.e.&nbsp;<code>@inheritParams anotherpackage::function</code>. This does introduce one small annoyance: now the documentation for your package is no longer self-contained and the version of <code>anotherpackage</code> can affect the generated docs. Beware of spurious diffs introduced by contributors who run <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> with a different installed version of the inherited-from package.</p>
</section></section><section id="sec-man-returns" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="sec-man-returns">
<span class="header-section-number">16.4</span> Return value</h2>
<p>A function’s output is as important as its inputs. Documenting the output is the job of the <code>@returns</code><a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> tag. Here the priority is to describe the overall “shape” of the output, i.e.&nbsp;what sort of object it is, and its dimensions (if that makes sense). For example, if your function returns a vector you might describe its type and length, or if your function returns a data frame you might describe the names and types of the columns and the expected number of rows.</p>
<p>The <code>@returns</code> documentation for functions in stringr is straightforward because almost all functions return some type of vector with the same length as one of the inputs. For example, here’s how <code><a href="https://stringr.tidyverse.org/reference/str_like.html">str_like()</a></code> describes its output:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @returns A logical vector the same length as `string`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A more complicated case is the joint documentation for <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate()</a></code> and <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate_all()</a></code><a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>. <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate()</a></code> returns an integer matrix, and <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate_all()</a></code> returns a list of matrices, so the text needs to describe what determines the rows and columns.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @returns</span></span>
<span><span class="co">#' * `str_locate()` returns an integer matrix with two columns and</span></span>
<span><span class="co">#'   one row for each element of `string`. The first column, `start`,</span></span>
<span><span class="co">#'   gives the position at the start of the match, and the second column, `end`,</span></span>
<span><span class="co">#'   gives the position of the end.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#'* `str_locate_all()` returns a list of integer matrices with the same</span></span>
<span><span class="co">#'   length as `string`/`pattern`. The matrices have columns `start` and `end`</span></span>
<span><span class="co">#'   as above, and one row for each match.</span></span>
<span><span class="co">#' @seealso</span></span>
<span><span class="co">#'   [str_extract()] for a convenient way of extracting matches,</span></span>
<span><span class="co">#'   [stringi::stri_locate()] for the underlying implementation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In other cases it can be easier to figure out what to highlight by thinking about the set of functions and how they differ. For example, most dplyr functions return a data frame, so just saying <code>@returns A data frame</code> is not very useful. Instead, we tried to identify exactly what makes each function different. We decided it makes sense to describe each function in terms of how it affects the rows, the columns, the groups, and the attributes. For example, this describes the return value of <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @returns</span></span>
<span><span class="co">#' An object of the same type as `.data`. The output has the following properties:</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' * Rows are a subset of the input, but appear in the same order.</span></span>
<span><span class="co">#' * Columns are not modified.</span></span>
<span><span class="co">#' * The number of groups may be reduced (if `.preserve` is not `TRUE`).</span></span>
<span><span class="co">#' * Data frame attributes are preserved.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>@returns</code> is also a good place to describe any important warnings or errors that the user might see. For example <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code> mentions what happens if there are any parsing problems:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @returns A [tibble()]. If there are parsing problems, a warning will alert you.</span></span>
<span><span class="co">#'   You can retrieve the full details by calling [problems()] on your dataset.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Submitting to CRAN
</div>
</div>
<div class="callout-body-container callout-body">
<p>For your initial CRAN submission, all functions must document their return value. While this may not be scrutinized in subsequent submissions, it’s still a good practice. There’s currently no way to check that you’ve documented the return value of every function (we’re <a href="https://github.com/r-lib/roxygen2/issues/1334">working on it</a>) which is why you’ll notice some tidyverse functions lack output documentation. But we certainly aspire to provide this information across the board.</p>
</div>
</div>
</section><section id="sec-man-examples" class="level2" data-number="16.5"><h2 data-number="16.5" class="anchored" data-anchor-id="sec-man-examples">
<span class="header-section-number">16.5</span> Examples</h2>
<p>Describing what a function does is great, but <em>showing</em> how it works is even better. That’s the role of the <code>@examples</code> tag, which uses executable R code to demonstrate what a function can do. Unlike other parts of the documentation where we’ve focused mainly on what you should write, here we’ll briefly give some content advice and then focus mainly on the mechanics.</p>
<p>The main dilemma with examples is that you must jointly satisfy two requirements:</p>
<ul>
<li><p>Your example code should be readable and realistic. Examples are documentation that you provide for the benefit of the user, i.e.&nbsp;a real human, working interactively, trying to get their actual work done with your package.</p></li>
<li><p>Your example code must run without error and with no side effects in many non-interactive contexts over which you have limited or no control, such as when CRAN runs <code>R CMD check</code> or when your package website is built via GitHub Actions.</p></li>
</ul>
<p>It turns out that there is often tension between these goals and you’ll need to find a way to make your examples as useful as you can for users, while also satisfying the requirements of CRAN (if that’s your goal) or other automated infrastructure.</p>
<p>The mechanics of examples are complex because they must never error and they’re executed in four different situations:</p>
<ul>
<li>Interactively using the <code><a href="https://rdrr.io/r/utils/example.html">example()</a></code> function.</li>
<li>During <code>R CMD check</code> on your computer, or another computer you control (e.g.&nbsp;in GitHub Actions).</li>
<li>During <code>R CMD check</code> run by CRAN.</li>
<li>When your pkgdown website is being built, often via GitHub Actions or similar.</li>
</ul>
<p>After discussing what to put in your examples, we’ll talk about keeping your examples self-contained, how to display errors if needed, handling dependencies, running examples conditionally, and alternatives to the <code>@examples</code> tag for including example code.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>When preparing <code>.R</code> scripts or <code>.Rmd</code> / <code>.qmd</code> reports, it’s handy to use Ctrl/Cmd + Enter or the <em>Run</em> button to send a line of R code to the console for execution. Happily, you can use the same workflow for executing and developing the <code>@examples</code> in your roxygen comments. Remember to do <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code> often, to stay synced with the package source.</p>
</div>
</div>
<section id="contents" class="level3" data-number="16.5.1"><h3 data-number="16.5.1" class="anchored" data-anchor-id="contents">
<span class="header-section-number">16.5.1</span> Contents</h3>
<p>Use examples to first show the basic operation of the function, then to highlight any particularly important properties. For example, <code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code> starts by showing a few simple variations and then highlights a feature that’s easy to miss: as well as passing a vector of strings and one pattern, you can also pass one string and vector of patterns.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examples</span></span>
<span><span class="co">#' fruit &lt;- c("apple", "banana", "pear", "pineapple")</span></span>
<span><span class="co">#' str_detect(fruit, "a")</span></span>
<span><span class="co">#' str_detect(fruit, "^a")</span></span>
<span><span class="co">#' str_detect(fruit, "a$")</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' # Also vectorised over pattern</span></span>
<span><span class="co">#' str_detect("aecfg", letters)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try to stay focused on the most important features without getting into the weeds of every last edge case: if you make the examples too long, it becomes hard for the user to find the key application that they’re looking for. If you find yourself writing very long examples, it may be a sign that you should write a vignette instead.</p>
<p>There aren’t any formal ways to break up your examples into sections but you can use sectioning comments that use many <code>---</code> to create a visual breakdown. Here’s an example from <code><a href="https://tidyr.tidyverse.org/reference/chop.html">tidyr::chop()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examples</span></span>
<span><span class="co">#' # Chop ----------------------------------------------------------------------</span></span>
<span><span class="co">#' df &lt;- tibble(x = c(1, 1, 1, 2, 2, 3), y = 1:6, z = 6:1)</span></span>
<span><span class="co">#' # Note that we get one row of output for each unique combination of</span></span>
<span><span class="co">#' # non-chopped variables</span></span>
<span><span class="co">#' df %&gt;% chop(c(y, z))</span></span>
<span><span class="co">#' # cf nest</span></span>
<span><span class="co">#' df %&gt;% nest(data = c(y, z))</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Unchop --------------------------------------------------------------------</span></span>
<span><span class="co">#' df &lt;- tibble(x = 1:4, y = list(integer(), 1L, 1:2, 1:3))</span></span>
<span><span class="co">#' df %&gt;% unchop(y)</span></span>
<span><span class="co">#' df %&gt;% unchop(y, keep_empty = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Strive to keep the examples focused on the specific function that you’re documenting. If you can make the point with a familiar built-in dataset, like <code>mtcars</code>, do so. If you find yourself needing to do a bunch of setup to create a dataset or object to use in the example, it may be a sign that you need to create a package dataset or even a helper function. See <a href="data.html" class="quarto-xref"><span>Chapter 7</span></a>, <a href="data.html#sec-data-example-path-helper" class="quarto-xref"><span>Section 7.3.2</span></a>, and <a href="testing-advanced.html#sec-testing-advanced-fixture-helper" class="quarto-xref"><span>Section 15.1.1</span></a> for ideas. Making it easy to write (and read) examples will greatly improve the quality of your documentation.</p>
<p>Also, remember that examples are not tests. Examples should be focused on the authentic and typical usage you’ve designed for and that you want to encourage. The test suite is the more appropriate place to exhaustively exercise all of the arguments and to explore weird, pathological edge cases.</p>
</section><section id="leave-the-world-as-you-found-it" class="level3" data-number="16.5.2"><h3 data-number="16.5.2" class="anchored" data-anchor-id="leave-the-world-as-you-found-it">
<span class="header-section-number">16.5.2</span> Leave the world as you found it</h3>
<p>Your examples should be self-contained. For example, this means:</p>
<ul>
<li>If you modify <code><a href="https://rdrr.io/r/base/options.html">options()</a></code>, reset them at the end of the example.</li>
<li>If you create a file, create it somewhere in <code><a href="https://rdrr.io/r/base/tempfile.html">tempdir()</a></code>, and make sure to delete it at the end of the example.</li>
<li>Don’t change the working directory.</li>
<li>Don’t write to the clipboard (unless a user is present to provide some form of consent).</li>
</ul>
<p>This has a lot of overlap with our recommendations for tests (see section <a href="testing-design.html#sec-testing-design-self-contained" class="quarto-xref"><span>Section 14.2.2</span></a>) and even for the R functions in your package (see section <a href="code.html#sec-code-r-landscape" class="quarto-xref"><span>Section 6.5</span></a>). However, due to the way that examples are run during <code>R CMD check</code>, the tools available for making examples self-contained are much more limited. Unfortunately, you can’t use the withr package or even <code><a href="https://rdrr.io/r/base/on.exit.html">on.exit()</a></code> to schedule clean up, like restoring options or deleting a file. Instead, you’ll need to do it by hand. If you can avoid doing something that must then be undone, that is the best way to go and this is especially true for examples.</p>
<p>These constraints are often in tension with good documentation, if you’re trying to document a function that somehow changes the state of the world. For example, you have to “show your work”, i.e.&nbsp;all of your code, which means that your users will see all of the setup and teardown, even if it is not typical for authentic usage. If you’re finding it hard to follow the rules, this might be another sign to switch to a vignette (see <a href="vignettes.html" class="quarto-xref"><span>Chapter 17</span></a>).</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Submitting to CRAN
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many of these constraints are also mentioned in the <a href="https://cran.r-project.org/web/packages/policies.html">CRAN repository policy</a>, which you must adhere to when submitting to CRAN. Use find in page to locate “malicious or anti-social” to see the details.</p>
</div>
</div>
<p>Additionally, you want your examples to send the user on a short walk, not a long hike. Examples need to execute relatively quickly so users can quickly see the results, it doesn’t take ages to build your website, automated checks happen quickly, and it doesn’t take up computing resources when submitting to CRAN.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Submitting to CRAN
</div>
</div>
<div class="callout-body-container callout-body">
<p>All examples must run in under 10 minutes.</p>
</div>
</div>
</section><section id="sec-man-examples-errors" class="level3" data-number="16.5.3"><h3 data-number="16.5.3" class="anchored" data-anchor-id="sec-man-examples-errors">
<span class="header-section-number">16.5.3</span> Errors</h3>
<p>Your examples cannot throw any errors, so don’t include flaky code that can fail for reasons beyond your control. In particular, it’s best to avoid accessing websites, because <code>R CMD check</code> will fail whenever the website is down.</p>
<p>What can you do if you want to include code that causes an error for the purposes of teaching? There are two basic options:</p>
<ul>
<li>
<p>You can wrap the code in <code><a href="https://rdrr.io/r/base/try.html">try()</a></code> so that the error is shown, but doesn’t stop execution of the examples. For example, <code><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">dplyr::bind_cols()</a></code> uses <code><a href="https://rdrr.io/r/base/try.html">try()</a></code> to show you what happens if you attempt to column-bind two data frames with different numbers of rows:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examples</span></span>
<span><span class="co">#' ...</span></span>
<span><span class="co">#' # Row sizes must be compatible when column-binding</span></span>
<span><span class="co">#' try(bind_cols(tibble(x = 1:3), tibble(y = 1:2)))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>You can wrap the code in <code>\dontrun{}</code><a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>, so it is never run by <code><a href="https://rdrr.io/r/utils/example.html">example()</a></code>. The example above would look like this if you used <code>\dontrun{}</code> instead of <code><a href="https://rdrr.io/r/base/try.html">try()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' # Row sizes must be compatible when column-binding</span></span>
<span><span class="co">#' \dontrun{</span></span>
<span><span class="co">#' bind_cols(tibble(x = 1:3), tibble(y = 1:2)))</span></span>
<span><span class="co">#' }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ul>
<p>We generally recommend using <code><a href="https://rdrr.io/r/base/try.html">try()</a></code> so that the reader can see an example of the error in action.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Submitting to CRAN
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the initial CRAN submission of your package, all functions must have at least one example and the example code can’t all be wrapped inside <code>\dontrun{}</code>. If the code can only be run under specific conditions, use the techniques below to express those pre-conditions.</p>
</div>
</div>
</section><section id="sec-man-examples-dependencies-conditional-execution" class="level3" data-number="16.5.4"><h3 data-number="16.5.4" class="anchored" data-anchor-id="sec-man-examples-dependencies-conditional-execution">
<span class="header-section-number">16.5.4</span> Dependencies and conditional execution</h3>
<p>An additional source of errors in examples is the use of external dependencies: you can only use packages in your examples that your package formally depends on (i.e.&nbsp;that appear in <code>Imports</code> or <code>Suggests</code>). Furthermore, example code is run in the user’s environment, not the package environment, so you’ll have to either explicitly attach the dependency with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> or refer to each function with <code>::</code>. For example, dbplyr is a dplyr extension package, so all of its examples start with <code><a href="https://dplyr.tidyverse.org">library(dplyr)</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examples</span></span>
<span><span class="co">#' library(dplyr)</span></span>
<span><span class="co">#' df &lt;- data.frame(x = 1, y = 2)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' df_sqlite &lt;- tbl_lazy(df, con = simulate_sqlite())</span></span>
<span><span class="co">#' df_sqlite %&gt;% summarise(x = sd(x, na.rm = TRUE)) %&gt;% show_query()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the past, we recommended only using code from suggested packages inside a block like this:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examples</span></span>
<span><span class="co">#' if (requireNamespace("suggestedpackage", quietly = TRUE)) { </span></span>
<span><span class="co">#'   # some example code</span></span>
<span><span class="co">#' }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We no longer believe that approach is a good idea, because:</p>
<ul>
<li>Our policy is to expect that suggested packages are installed when running <code>R CMD check</code><a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> and this informs what we do in examples, tests, and vignettes.</li>
<li>The cost of putting example code inside <code>{ … }</code> is high: you can no longer see intermediate results, such as when the examples are rendered in the package’s website. The cost of a package not being installed is low: users can usually recognize the associated error and resolve it themselves, i.e.&nbsp;by installing the missing package.</li>
</ul>
<p>In other cases, your example code may depend on something other than a package. For example, if your examples talk to a web API, you probably only want to run them for an authenticated user, and never want such code to run on CRAN. In this case, you really do need conditional execution. The entry-level solution is to express this explicitly:</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examples</span></span>
<span><span class="co">#' if (some_condition()) {</span></span>
<span><span class="co">#'   # some example code</span></span>
<span><span class="co">#' }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The condition could be quite general, such as <code><a href="https://rdrr.io/r/base/interactive.html">interactive()</a></code>, or very specific, such as a custom predicate function provided by your package. But this use of <code>if()</code> still suffers from the downside highlighted above, where the rendered examples don’t clearly show what’s going on inside the <code>{ … }</code> block.</p>
<p>The <code>@examplesIf</code> tag is a great alternative to <code>@examples</code> in this case:</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examplesIf some_condition()</span></span>
<span><span class="co">#' some_other_function()</span></span>
<span><span class="co">#' some_more_functions()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This looks almost like the snippet just above, but has several advantages:</p>
<ul>
<li><p>Users won’t actually see the <code>if() { … }</code> machinery when they are reading your documentation from within R or on a pkgdown website. Users only see realistic code.</p></li>
<li><p>The example code renders fully in pkgdown.</p></li>
<li><p>The example code runs when it should and does not run when it should not.</p></li>
<li><p>This doesn’t run afoul of CRAN’s prohibition of putting all your example code inside <code>\dontrun{}</code>.</p></li>
</ul>
<p>For example, <a href="https://googledrive.tidyverse.org/reference/index.html">googledrive</a> uses <code>@examplesIf</code> in almost every function, guarded by <code><a href="https://googledrive.tidyverse.org/reference/drive_has_token.html">googledrive::drive_has_token()</a></code>. Here’s how the examples for <code><a href="https://googledrive.tidyverse.org/reference/drive_publish.html">googledrive::drive_publish()</a></code> begin:</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @examplesIf drive_has_token()</span></span>
<span><span class="co">#' # Create a file to publish</span></span>
<span><span class="co">#' file &lt;- drive_example_remote("chicken_sheet") %&gt;%</span></span>
<span><span class="co">#'   drive_cp()</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Publish file</span></span>
<span><span class="co">#' file &lt;- drive_publish(file)</span></span>
<span><span class="co">#' ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The example code doesn’t run on CRAN, because there’s no token. It does run when the pkgdown site is built, because we can set up a token securely. And, if a normal user executes this code, they’ll be prompted to sign in to Google, if they haven’t already.</p>
</section><section id="intermixing-examples-and-text" class="level3" data-number="16.5.5"><h3 data-number="16.5.5" class="anchored" data-anchor-id="intermixing-examples-and-text">
<span class="header-section-number">16.5.5</span> Intermixing examples and text</h3>
<p>An alternative to examples is to use R Markdown code blocks elsewhere in your roxygen comments, either <code>```R</code> if you just want to show some code, or <code>```{r}</code> if you want the code to be run. These can be effective techniques but there are downsides to each:</p>
<ul>
<li>The code in <code>```R</code> blocks is never run; this means it’s easy to accidentally introduce syntax errors or to forget to update it when your package changes.</li>
<li>The code in <code>```{r}</code> blocks is run every time you document the package. This has the nice advantage of including the output in the documentation (unlike examples), but the code can’t take very long to run or your iterative documentation workflow will become quite painful.</li>
</ul></section></section><section id="re-using-documentation" class="level2" data-number="16.6"><h2 data-number="16.6" class="anchored" data-anchor-id="re-using-documentation">
<span class="header-section-number">16.6</span> Re-using documentation</h2>
<p>roxygen2 provides a number of features that allow you to reuse documentation across topics. They are documented in <code><a href="https://roxygen2.r-lib.org/articles/reuse.html">vignette("reuse", package = "roxygen2")</a></code>, so here we’ll focus on the three most important:</p>
<ul>
<li>Documenting multiple functions in one topic.</li>
<li>Inheriting documentation from another topic.</li>
<li>Using child documents to share prose between topics, or to share between documentation topics and vignettes.</li>
</ul>
<section id="sec-man-multiple-functions" class="level3" data-number="16.6.1"><h3 data-number="16.6.1" class="anchored" data-anchor-id="sec-man-multiple-functions">
<span class="header-section-number">16.6.1</span> Multiple functions in one topic</h3>
<p>By default, each function gets its own documentation topic, but if two functions are very closely connected, you can combine the documentation for multiple functions into a single topic. For example, take <code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code> and <code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_width()</a></code>, which provide two different ways of computing the size of a string. As you can see from the description, both functions are documented together, because this makes it easier to see how they differ:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' The length/width of a string</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' `str_length()` returns the number of codepoints in a string. These are</span></span>
<span><span class="co">#' the individual elements (which are often, but not always letters) that</span></span>
<span><span class="co">#' can be extracted with [str_sub()].</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' `str_width()` returns how much space the string will occupy when printed</span></span>
<span><span class="co">#' in a fixed width font (i.e. when printed in the console).</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' ...</span></span>
<span><span class="va">str_length</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">string</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">...</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To merge the two topics, <code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_width()</a></code> uses <code>@rdname str_length</code> to add its documentation to an existing topic:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @rdname str_length</span></span>
<span><span class="va">str_width</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">string</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">...</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This technique works best for functions that have a lot in common, i.e.&nbsp;similar return values and examples, in addition to similar arguments.</p>
</section><section id="inheriting-documentation" class="level3" data-number="16.6.2"><h3 data-number="16.6.2" class="anchored" data-anchor-id="inheriting-documentation">
<span class="header-section-number">16.6.2</span> Inheriting documentation</h3>
<p>In other cases, functions in a package might share many related behaviors, but aren’t closely enough connected that you want to document them together. We’ve discussed <code>@inheritParams</code> above, but there are three variations that allow you to inherit other things:</p>
<ul>
<li><p><code>@inherit source_function</code> will inherit all supported components from <code>source_function()</code>.</p></li>
<li><p><code>@inheritSection source_function Section title</code> will inherit the single section with title “Section title” from <code>source_function()</code>.</p></li>
<li><p><code>@inheritDotParams</code> automatically generates parameter documentation for <code>...</code> for the common case where you pass <code>...</code> on to another function.</p></li>
</ul>
<p>See <a href="https://roxygen2.r-lib.org/articles/reuse.html#inheriting-documentation" class="uri">https://roxygen2.r-lib.org/articles/reuse.html#inheriting-documentation</a> for more details.</p>
</section><section id="child-documents" class="level3" data-number="16.6.3"><h3 data-number="16.6.3" class="anchored" data-anchor-id="child-documents">
<span class="header-section-number">16.6.3</span> Child documents</h3>
<p>Finally, you can reuse the same <code>.Rmd</code> or <code>.md</code> document in the function documentation, <code>README.Rmd</code>, and vignettes by using R Markdown child documents. The syntax looks like this:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' ```{r child = "man/rmd/filename.Rmd"}</span></span>
<span><span class="co">#' ```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is a feature we use very sparingly in the tidyverse, but one place we do use it is in dplyr, because a number of functions use the same syntax as <code>select()</code> and we want to provide all the info in one place:</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' # Overview of selection features</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' ```{r, child = "man/rmd/overview.Rmd"}</span></span>
<span><span class="co">#' ```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then <code>man/rmd/overview.Rmd</code> contains the repeated markdown:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Tidyverse selections implement a dialect of R where operators make</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>it easy to select variables:</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`:`</span> for selecting a range of consecutive variables.</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`!`</span> for taking the complement of a set of variables.</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`&amp;`</span> and <span class="in">`|`</span> for selecting the intersection or the union of two</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  sets of variables.</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`c()`</span> for combining selections.</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the Rmd file contains roxygen (Markdown-style) links to other help topics, then some care is needed. See <a href="https://roxygen2.r-lib.org/dev/articles/reuse.html#child-documents" class="uri">https://roxygen2.r-lib.org/dev/articles/reuse.html#child-documents</a> for details.</p>
</section></section><section id="sec-man-package-doc" class="level2" data-number="16.7"><h2 data-number="16.7" class="anchored" data-anchor-id="sec-man-package-doc">
<span class="header-section-number">16.7</span> Help topic for the package</h2>
<p>This chapter focuses on function documentation, but remember you can document other things, as detailed in <code><a href="https://roxygen2.r-lib.org/articles/rd-other.html">vignette("rd-other", package = "roxygen2")</a></code>. In particular, you can create a help topic for the package itself by documenting the special sentinel <code>"_PACKAGE"</code>. The resulting <code>.Rd</code> file automatically pulls in information parsed from the <code>DESCRIPTION</code>, including title, description, list of authors, and useful URLs. This help topic appears alongside all your other topics and can also be accessed with <code>package?pkgname</code>, e.g.&nbsp;<code>package?usethis</code>, or even just <code>?usethis</code>.</p>
<p>We recommend calling <code><a href="https://usethis.r-lib.org/reference/use_package_doc.html">usethis::use_package_doc()</a></code> to set up this package-level documentation in a dummy file <code>R/{pkgname}-package.R</code>, whose contents will look something like this:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @keywords internal </span></span>
<span><span class="st">"_PACKAGE"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>R/{pkgname}-package.R</code> file is the main reason we wanted to mention <code>use_package_doc()</code> and package-level documentation here. It turns out there are a few other package-wide housekeeping tasks for which this file is a very natural home. For example, it’s a sensible, central location for import directives, i.e.&nbsp;for importing individual functions from your dependencies or even entire namespaces. In <a href="dependencies-in-practice.html#sec-dependencies-in-imports-r-code" class="quarto-xref"><span>Section 11.4.1</span></a>, we recommend importing specific functions via <code><a href="https://usethis.r-lib.org/reference/use_import_from.html">usethis::use_import_from()</a></code> and this function is designed to write the associated roxygen tags into the <code>R/{pkgname}-package.R</code> file created by <code>use_package_doc()</code>. So, putting it all together, this is a minimal example of how the <code>R/{pkgname}-package.R</code> file might look:</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @keywords internal </span></span>
<span><span class="st">"_PACKAGE"</span></span>
<span></span>
<span><span class="co"># The following block is used by usethis to automatically manage</span></span>
<span><span class="co"># roxygen namespace tags. Modify with care!</span></span>
<span><span class="co">## usethis namespace: start</span></span>
<span><span class="co">#' @importFrom glue glue_collapse</span></span>
<span><span class="co">## usethis namespace: end</span></span>
<span><span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The name “roxygen” is a nod to the Doxygen documentation generator, which inspired the development of an R package named roxygen. Then that original concept was rebooted as roxygen2, similar to ggplot2.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The NAMESPACE file is also generated from these roxygen comments. Or, rather, it <em>can</em> be and that is the preferred devtools workflow (<a href="dependencies-in-practice.html#sec-dependencies-NAMESPACE-workflow" class="quarto-xref"><span>Section 11.3</span></a>).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Running <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> also affects another field in <code>DESCRIPTION</code>, which looks like this: <code>RoxygenNote: 7.2.1</code>. This records which version of roxygen2 was last used in a package, which makes it easier for devtools (and its underlying packages) to make an intelligent guess about when to re-<code>document()</code> a package and when to leave well enough alone. In a collaborative setting, this also reduces nuisance changes to the <code>.Rd</code> files, by making the relevant roxygen2 version highly visible.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>This is part of the explanation promised in <a href="description.html#sec-description-custom-fields" class="quarto-xref"><span>Section 9.8</span></a>, where we also clarify that, with our current conventions, this field should really be called <code>Config/Needs/roxygen</code>, instead of <code>Roxygen</code>. We highly recommend that you use markdown in all new packages and that you migrate older-but-actively maintained packages to markdown syntax. In this case, you can call <code><a href="https://usethis.r-lib.org/reference/use_roxygen_md.html">usethis::use_roxygen_md()</a></code> to update <code>DESCRIPTION</code> and get a reminder about the roxygen2md package, which can help with conversion.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Or the end of the block, if it’s the last tag.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The name of the file is automatically derived from the object you’re documenting.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>These calls include an explicit specification of <code>package = "somepackage"</code>, since it can’t be inferred from context, i.e.&nbsp;the context is a Quarto book, not package documentation.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Like all the examples, these might have changed a bit since we wrote this book, because we’re constantly striving to do better. You might compare what’s in the book to what we now use, and consider if you think if it’s an improvement.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>In older code, you might see the use of <code>@section title:</code> which was used to create sections before roxygen2 had full markdown support. If you’ve used these in the past, you can now turn them into markdown headings.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>For historical reasons, you can also use <code>@return</code>, but we now favor <code>@returns</code> because it reads more naturally.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>We’ll come back how to document multiple functions in one topic in <a href="#sec-man-multiple-functions" class="quarto-xref"><span>Section 16.6.1</span></a>.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>You used to be able to use <code>\donttest{}</code> for a similar purpose, but we no longer recommend it because CRAN sets a special flag that causes the code to be executed anyway.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>This is certainly true for CRAN and is true in most other automated checking scenarios, such as our GitHub Actions workflows.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/r-pkgs\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./testing-advanced.html" class="pagination-link" aria-label="Advanced testing techniques">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Advanced testing techniques</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./vignettes.html" class="pagination-link" aria-label="Vignettes">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vignettes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/man.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>