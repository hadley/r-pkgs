<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to create a package, the fundamental unit of shareable, reusable, and reproducible R code.">
<title>4&nbsp; Fundamental development workflows – R Packages (2e)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./package-within.html" rel="next">
<link href="./structure.html" rel="prev">
<link href="./images/cover-2e-small.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-cecd649be66239f4a3c9dceaf651ba2d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r-pkgs.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./whole-game.html">Getting started</a></li><li class="breadcrumb-item"><a href="./workflow101.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Packages (2e)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hadley/r-pkgs/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Whole Game</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">System setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow101.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./package-within.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The package within</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Package components</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Other components</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Package metadata</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><code>DESCRIPTION</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-mindset-background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dependencies: Mindset and Background</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-in-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dependencies: In Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Licensing</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Testing basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Designing your test suite</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Advanced testing techniques</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./man.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vignettes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vignettes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Other markdown files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Website</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Maintenance and distribution</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software-development-practices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Software development practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lifecycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Lifecycle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./release.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Releasing to CRAN</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-CMD-check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#sec-workflow101-create-package" id="toc-sec-workflow101-create-package" class="nav-link active" data-scroll-target="#sec-workflow101-create-package"><span class="header-section-number">4.1</span> Create a package</a>
  <ul class="collapse">
<li><a href="#survey-the-existing-landscape" id="toc-survey-the-existing-landscape" class="nav-link" data-scroll-target="#survey-the-existing-landscape"><span class="header-section-number">4.1.1</span> Survey the existing landscape</a></li>
  <li><a href="#name-your-package" id="toc-name-your-package" class="nav-link" data-scroll-target="#name-your-package"><span class="header-section-number">4.1.2</span> Name your package</a></li>
  <li><a href="#sec-creating" id="toc-sec-creating" class="nav-link" data-scroll-target="#sec-creating"><span class="header-section-number">4.1.3</span> Package creation</a></li>
  <li><a href="#where-should-you-create_package" id="toc-where-should-you-create_package" class="nav-link" data-scroll-target="#where-should-you-create_package"><span class="header-section-number">4.1.4</span> Where should you <code>create_package()</code>?</a></li>
  </ul>
</li>
  <li>
<a href="#sec-workflow101-rstudio-projects" id="toc-sec-workflow101-rstudio-projects" class="nav-link" data-scroll-target="#sec-workflow101-rstudio-projects"><span class="header-section-number">4.2</span> RStudio Projects</a>
  <ul class="collapse">
<li><a href="#benefits-of-rstudio-projects" id="toc-benefits-of-rstudio-projects" class="nav-link" data-scroll-target="#benefits-of-rstudio-projects"><span class="header-section-number">4.2.1</span> Benefits of RStudio Projects</a></li>
  <li><a href="#how-to-get-an-rstudio-project" id="toc-how-to-get-an-rstudio-project" class="nav-link" data-scroll-target="#how-to-get-an-rstudio-project"><span class="header-section-number">4.2.2</span> How to get an RStudio Project</a></li>
  <li><a href="#what-makes-an-rstudio-project" id="toc-what-makes-an-rstudio-project" class="nav-link" data-scroll-target="#what-makes-an-rstudio-project"><span class="header-section-number">4.2.3</span> What makes an RStudio Project?</a></li>
  <li><a href="#how-to-launch-an-rstudio-project" id="toc-how-to-launch-an-rstudio-project" class="nav-link" data-scroll-target="#how-to-launch-an-rstudio-project"><span class="header-section-number">4.2.4</span> How to launch an RStudio Project</a></li>
  <li><a href="#sec-rstudio-project-vs-active-usethis-project" id="toc-sec-rstudio-project-vs-active-usethis-project" class="nav-link" data-scroll-target="#sec-rstudio-project-vs-active-usethis-project"><span class="header-section-number">4.2.5</span> RStudio Project vs.&nbsp;active usethis project</a></li>
  </ul>
</li>
  <li><a href="#working-directory-and-filepath-discipline" id="toc-working-directory-and-filepath-discipline" class="nav-link" data-scroll-target="#working-directory-and-filepath-discipline"><span class="header-section-number">4.3</span> Working directory and filepath discipline</a></li>
  <li>
<a href="#sec-workflow101-load-all" id="toc-sec-workflow101-load-all" class="nav-link" data-scroll-target="#sec-workflow101-load-all"><span class="header-section-number">4.4</span> Test drive with <code>load_all()</code></a>
  <ul class="collapse">
<li><a href="#benefits-of-load_all" id="toc-benefits-of-load_all" class="nav-link" data-scroll-target="#benefits-of-load_all"><span class="header-section-number">4.4.1</span> Benefits of <code>load_all()</code></a></li>
  <li><a href="#other-ways-to-call-load_all" id="toc-other-ways-to-call-load_all" class="nav-link" data-scroll-target="#other-ways-to-call-load_all"><span class="header-section-number">4.4.2</span> Other ways to call <code>load_all()</code></a></li>
  </ul>
</li>
  <li>
<a href="#sec-workflow101-r-cmd-check" id="toc-sec-workflow101-r-cmd-check" class="nav-link" data-scroll-target="#sec-workflow101-r-cmd-check"><span class="header-section-number">4.5</span> <code>check()</code> and <code>R CMD check</code></a>
  <ul class="collapse">
<li><a href="#check-workflow" id="toc-check-workflow" class="nav-link" data-scroll-target="#check-workflow"><span class="header-section-number">4.5.1</span> Workflow</a></li>
  <li><a href="#background-on-r-cmd-check" id="toc-background-on-r-cmd-check" class="nav-link" data-scroll-target="#background-on-r-cmd-check"><span class="header-section-number">4.5.2</span> Background on <code>R CMD check</code></a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/workflow101.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./whole-game.html">Getting started</a></li><li class="breadcrumb-item"><a href="./workflow101.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-workflow101" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Having peeked under the hood of R packages and libraries in <a href="structure.html" class="quarto-xref"><span>Chapter 3</span></a>, here we provide the basic workflows for creating a package and moving it through the different states that come up during development.</p>
<section id="sec-workflow101-create-package" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="sec-workflow101-create-package">
<span class="header-section-number">4.1</span> Create a package</h2>
<section id="survey-the-existing-landscape" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="survey-the-existing-landscape">
<span class="header-section-number">4.1.1</span> Survey the existing landscape</h3>
<p>Many packages are born out of one person’s frustration at some common task that should be easier. How should you decide whether something is package-worthy? There’s no definitive answer, but it’s helpful to appreciate at least two types of payoff:</p>
<ul>
<li>Product: your life will be better when this functionality is implemented formally, in a package.</li>
<li>Process: greater mastery of R will make you more effective in your work.</li>
</ul>
<p>If all you care about is the existence of a product, then your main goal is to navigate the space of existing packages. Silge, Nash, and Graves organized a survey and sessions around this at useR! 2017 and their write up for the R Journal <span class="citation" data-cites="silge-nash-graves">(<a href="references.html#ref-silge-nash-graves" role="doc-biblioref">Silge, Nash, and Graves 2018</a>)</span> provides a comprehensive roundup of resources.</p>
<p>If you are looking for ways to increase your R mastery, you should still educate yourself about the landscape. But there are plenty of good reasons to make your own package, even if there is relevant prior work. The way experts got that way is by actually building things, often very basic things, and you deserve the same chance to learn by tinkering. If you’re only allowed to work on things that have never been touched, you’re likely looking at problems that are either very obscure or very difficult.</p>
<p>It’s also valid to evaluate the suitability of existing tools on the basis of user interface, defaults, and edge case behaviour. A package may technically do what you need, but perhaps it’s very unergonomic for your use case. In this case, it may make sense for you to develop your own implementation or to write wrapper functions that smooth over the sharp edges.</p>
<p>If your work falls into a well-defined domain, educate yourself about the existing R packages, even if you’ve resolved to create your own package. Do they follow specific design patterns? Are there specific data structures that are common as the primary input and output? For example, there is a very active R community around spatial data analysis (<a href="https://www.r-spatial.org">r-spatial.org</a>) that has successfully self-organised to promote greater consistency across packages with different maintainers. In modeling, the <a href="https://hardhat.tidymodels.org">hardhat package</a> provides scaffolding for creating a modeling package that plays well with the <a href="https://www.tidymodels.org">tidymodels</a> ecosystem. Your package will get more usage and will need less documentation if it fits nicely into the surrounding landscape.</p>
</section><section id="name-your-package" class="level3" data-number="4.1.2"><h3 data-number="4.1.2" class="anchored" data-anchor-id="name-your-package">
<span class="header-section-number">4.1.2</span> Name your package</h3>
<blockquote class="blockquote">
<p>“There are only two hard things in Computer Science: cache invalidation and naming things.”</p>
<p>— Phil Karlton</p>
</blockquote>
<p>Before you can create your package, you need to come up with a name for it. This can be the hardest part of creating a package! (Not least because no one can automate it for you.)</p>
<section id="formal-requirements" class="level4" data-number="4.1.2.1"><h4 data-number="4.1.2.1" class="anchored" data-anchor-id="formal-requirements">
<span class="header-section-number">4.1.2.1</span> Formal requirements</h4>
<p>There are three formal requirements:</p>
<ol type="1">
<li>The name can only consist of letters, numbers, and periods, i.e., <code>.</code>.</li>
<li>It must start with a letter.</li>
<li>It cannot end with a period.</li>
</ol>
<p>Unfortunately, this means you can’t use either hyphens or underscores, i.e., <code>-</code> or <code>_</code>, in your package name. We recommend against using periods in package names, due to confusing associations with file extensions and S3 methods.</p>
</section><section id="things-to-consider" class="level4" data-number="4.1.2.2"><h4 data-number="4.1.2.2" class="anchored" data-anchor-id="things-to-consider">
<span class="header-section-number">4.1.2.2</span> Things to consider</h4>
<p>If you plan to share your package with others, it’s important to come up with a good name. Here are some tips:</p>
<ul>
<li><p>Pick a unique name that’s easy to Google. This makes it easy for potential users to find your package (and associated resources) and for you to see who’s using it.</p></li>
<li>
<p>Don’t pick a name that’s already in use on CRAN or Bioconductor. You may also want to consider some other types of name collision:</p>
<ul>
<li>Is there an in-development package maturing on, say, GitHub that already has some history and seems to be heading towards release?</li>
<li>Is this name already used for another piece of software or for a library or framework in, e.g., the Python or JavaScript ecosystem?</li>
</ul>
</li>
<li><p>Avoid using both upper and lower case letters: doing so makes the package name hard to type and even harder to remember. For example, it’s hard to remember if it’s Rgtk2 or RGTK2 or RGtk2.</p></li>
<li><p>Give preference to names that are pronounceable, so people are comfortable talking about your package and have a way to hear it inside their head.</p></li>
<li>
<p>Find a word that evokes the problem and modify it so that it’s unique. Here are some examples:</p>
<ul>
<li>lubridate makes dates and times easier.</li>
<li>rvest “harvests” the content from web pages.</li>
<li>r2d3 provides utilities for working with D3 visualizations.</li>
<li>forcats is an anagram of factors, which we use <strong>for</strong> <strong>cat</strong>egorical data.</li>
</ul>
</li>
<li>
<p>Use abbreviations, like the following:</p>
<ul>
<li>Rcpp = R + C++ (plus plus)</li>
<li>brms = Bayesian Regression Models using Stan</li>
</ul>
</li>
<li>
<p>Add an extra R, for example:</p>
<ul>
<li>stringr provides string tools.</li>
<li>beepr plays notification sounds.</li>
<li>callr calls R, from R.</li>
</ul>
</li>
<li>
<p>Don’t get sued.</p>
<ul>
<li>If you’re creating a package that talks to a commercial service, check the branding guidelines. For example, rDrop isn’t called rDropbox because Dropbox prohibits any applications from using the full trademarked name.</li>
</ul>
</li>
</ul>
<p>Nick Tierney presents a fun typology of package names in his <a href="https://www.njtierney.com/post/2018/06/20/naming-things/">Naming Things</a> blog post, which also includes more inspiring examples. He also has some experience with renaming packages; the post <a href="https://www.njtierney.com/post/2017/10/27/change-pkg-name/">So, you’ve decided to change your r package name</a> is a good resource if you don’t get this right the first time.</p>
</section><section id="use-the-available-package" class="level4" data-number="4.1.2.3"><h4 data-number="4.1.2.3" class="anchored" data-anchor-id="use-the-available-package">
<span class="header-section-number">4.1.2.3</span> Use the available package</h4>
<p>It is impossible to abide by all of the above suggestions simultaneously, so you will need to make some trade-offs. The <a href="https://cran.r-project.org/package=available">available package</a> has a function called <code>available()</code> that helps you evaluate a potential package name from many angles:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/available">available</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">available</span><span class="op">(</span><span class="st">"doofus"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Urban Dictionary can contain potentially offensive results,</span></span>
<span><span class="co">#&gt;   should they be included? [Y]es / [N]o:</span></span>
<span><span class="co">#&gt; 1: 1</span></span>
<span><span class="co">#&gt; ── doofus ──────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Name valid: ✔</span></span>
<span><span class="co">#&gt; Available on CRAN: ✔ </span></span>
<span><span class="co">#&gt; Available on Bioconductor: ✔</span></span>
<span><span class="co">#&gt; Available on GitHub:  ✔ </span></span>
<span><span class="co">#&gt; Abbreviations: http://www.abbreviations.com/doofus</span></span>
<span><span class="co">#&gt; Wikipedia: https://en.wikipedia.org/wiki/doofus</span></span>
<span><span class="co">#&gt; Wiktionary: https://en.wiktionary.org/wiki/doofus</span></span>
<span><span class="co">#&gt; Sentiment:???</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>available::available()</code> does the following:</p>
<ul>
<li>Checks for validity.</li>
<li>Checks availability on CRAN, Bioconductor, and beyond.</li>
<li>Searches various websites to help you discover any unintended meanings. In an interactive session, the URLs you see above are opened in browser tabs.</li>
<li>Attempts to report whether name has positive or negative sentiment.</li>
</ul>
<p><code><a href="https://pak.r-lib.org/reference/pkg_name_check.html">pak::pkg_name_check()</a></code> is alternative function with a similar purpose. Since the pak package is under more active development than available, it may emerge as the better option going forward.</p>
</section></section><section id="sec-creating" class="level3" data-number="4.1.3"><h3 data-number="4.1.3" class="anchored" data-anchor-id="sec-creating">
<span class="header-section-number">4.1.3</span> Package creation</h3>
<p>Once you’ve come up with a name, there are two ways to create the package.</p>
<ul>
<li>Call <code><a href="https://usethis.r-lib.org/reference/create_package.html">usethis::create_package()</a></code>.</li>
<li>In RStudio, do <em>File &gt; New Project &gt; New Directory &gt; R Package</em>. This ultimately calls <code><a href="https://usethis.r-lib.org/reference/create_package.html">usethis::create_package()</a></code>, so really there’s just one way.</li>
</ul>
<!-- *TODO: revisit when I tackle usethis + RStudio project templates <https://github.com/r-lib/usethis/issues/770>. In particular, contemplate whether to reinstate any screenshot-y coverage of RStudio workflows here.* --><p>This produces the smallest possible <em>working</em> package, with three components:</p>
<ol type="1">
<li><p>An <code>R/</code> directory, which you’ll learn about in <a href="code.html" class="quarto-xref"><span>Chapter 6</span></a>.</p></li>
<li><p>A basic <code>DESCRIPTION</code> file, which you’ll learn about in <a href="description.html" class="quarto-xref"><span>Chapter 9</span></a>.</p></li>
<li><p>A basic <code>NAMESPACE</code> file, which you’ll learn about in <a href="dependencies-mindset-background.html#sec-dependencies-NAMESPACE-file" class="quarto-xref"><span>Section 10.2.2</span></a>.</p></li>
</ol>
<p>It may also include an RStudio project file, <code>pkgname.Rproj</code>, that makes your package easy to use with RStudio, as described below. Basic <code>.Rbuildignore</code> and <code>.gitignore</code> files are also left behind.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Don’t use <code><a href="https://rdrr.io/r/utils/package.skeleton.html">package.skeleton()</a></code> to create a package. Because this function comes with R, you might be tempted to use it, but it creates a package that immediately throws errors with <code>R CMD build</code>. It anticipates a different development process than we use here, so repairing this broken initial state just makes unnecessary work for people who use devtools (and, especially, roxygen2). Use <code>create_package()</code>.</p>
</div>
</div>
</section><section id="where-should-you-create_package" class="level3" data-number="4.1.4"><h3 data-number="4.1.4" class="anchored" data-anchor-id="where-should-you-create_package">
<span class="header-section-number">4.1.4</span> Where should you <code>create_package()</code>?</h3>
<p>The main and only required argument to <code>create_package()</code> is the <code>path</code> where your new package will live:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">create_package</span><span class="op">(</span><span class="st">"path/to/package/pkgname"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Remember that this is where your package lives in its <strong>source</strong> form (<a href="structure.html#sec-source-package" class="quarto-xref"><span>Section 3.2</span></a>), not in its <strong>installed</strong> form (<a href="structure.html#sec-installed-package" class="quarto-xref"><span>Section 3.5</span></a>). Installed packages live in a <strong>library</strong> and we discussed conventional setups for libraries in <a href="structure.html#sec-library" class="quarto-xref"><span>Section 3.7</span></a>.</p>
<p>Where should you keep source packages? The main principle is that this location should be distinct from where installed packages live. In the absence of external considerations, a typical user should designate a directory inside their home directory for R (source) packages. We discussed this with colleagues and the source of many tidyverse packages lives inside directories like <code>~/rrr/</code>, <code>~/documents/tidyverse/</code>, <code>~/r/packages/</code>, or <code>~/pkg/</code>. Some of us use one directory for this, others divide source packages among a few directories based on their development role (contributor vs.&nbsp;not), GitHub organization (tidyverse vs r-lib), development stage (active vs.&nbsp;not), and so on.</p>
<p>The above probably reflects that we are primarily tool-builders. An academic researcher might organize their files around individual publications, whereas a data scientist might organize around data products and reports. There is no particular technical or traditional reason for one specific approach. As long as you keep a clear distinction between source and installed packages, just pick a strategy that works within your overall system for file organization, and use it consistently.</p>
</section></section><section id="sec-workflow101-rstudio-projects" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="sec-workflow101-rstudio-projects">
<span class="header-section-number">4.2</span> RStudio Projects</h2>
<p>devtools works hand-in-hand with RStudio, which we believe is the best development environment for most R users. To be clear, you can use devtools without using RStudio and you can develop packages in RStudio without using devtools. But there is a special, two-way relationship that makes it very rewarding to use devtools and RStudio together.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>An RStudio <strong>Project</strong>, with a capital “P”, is a regular directory on your computer that includes some (mostly hidden) RStudio infrastructure to facilitate your work on one or more <strong>projects</strong>, with a lowercase “p”. A project might be an R package, a data analysis, a Shiny app, a book, a blog, etc.</p>
</div>
</div>
<section id="benefits-of-rstudio-projects" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="benefits-of-rstudio-projects">
<span class="header-section-number">4.2.1</span> Benefits of RStudio Projects</h3>
<p>From <a href="structure.html#sec-source-package" class="quarto-xref"><span>Section 3.2</span></a>, you already know that a source package lives in a directory on your computer. We strongly recommend that each source package is also an RStudio Project. Here are some of the payoffs:</p>
<ul>
<li><p>Projects are very “launch-able”. It’s easy to fire up a fresh instance of RStudio in a Project, with the file browser and working directory set exactly the way you need, ready for work.</p></li>
<li>
<p>Each Project is isolated; code run in one Project does not affect any other Project.</p>
<ul>
<li>You can have several RStudio Projects open at once and code executed in Project A does not have any effect on the R session and workspace of Project B.</li>
</ul>
</li>
<li><p>You get handy code navigation tools like <code>F2</code> to jump to a function definition and <code>Ctrl + .</code> to look up functions or files by name.</p></li>
<li>
<p>You get useful keyboard shortcuts and a clickable interface for common package development tasks, like generating documentation, running tests, or checking the entire package.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-keyboard-shortcuts" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of an RStudio window with a semi-transparent black box displaying keyboard shortcuts that overlays a majority of the window.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-keyboard-shortcuts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/keyboard-shortcuts.png" class="img-fluid figure-img" alt="Screenshot of an RStudio window with a semi-transparent black box displaying keyboard shortcuts that overlays a majority of the window.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-keyboard-shortcuts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Keyboard Shortcut Quick Reference in RStudio.
</figcaption></figure>
</div>
</div>
</div>
</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>To see the most useful keyboard shortcuts, press Alt + Shift + K or use <em>Help &gt; Keyboard Shortcuts Help</em>. You should see something like <a href="#fig-keyboard-shortcuts" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>.</p>
<p>RStudio also provides the <a href="https://docs.posit.co/ide/user/ide/reference/shortcuts.html#command-palette"><em>Command Palette</em></a> which gives fast, searchable access to all of the IDE’s commands – especially helpful when you can’t remember a particular keyboard shortcut. It is invoked via Ctrl + Shift + P (Windows &amp; Linux) or Cmd + Shift + P (macOS).</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>Follow @<a href="https://twitter.com/rstudiotips">rstudiotips</a> on Twitter for a regular dose of RStudio tips and tricks.</p>
</div>
</div>
</section><section id="how-to-get-an-rstudio-project" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="how-to-get-an-rstudio-project">
<span class="header-section-number">4.2.2</span> How to get an RStudio Project</h3>
<p>If you follow our recommendation to create new packages with <code>create_package()</code>, each new package will also be an RStudio Project, if you’re working from RStudio.</p>
<p>If you need to designate the directory of a pre-existing source package as an RStudio Project, choose one of these options:</p>
<ul>
<li>In RStudio, do <em>File &gt; New Project &gt; Existing Directory</em>.</li>
<li>Call <code>create_package()</code> with the path to the pre-existing R source package.</li>
<li>Call <code><a href="https://usethis.r-lib.org/reference/use_rstudio.html">usethis::use_rstudio()</a></code>, with the <a href="#sec-rstudio-project-vs-active-usethis-project">active usethis project</a> set to an existing R package. In practice, this probably means you just need to make sure your working directory is inside the pre-existing package directory.</li>
</ul></section><section id="what-makes-an-rstudio-project" class="level3" data-number="4.2.3"><h3 data-number="4.2.3" class="anchored" data-anchor-id="what-makes-an-rstudio-project">
<span class="header-section-number">4.2.3</span> What makes an RStudio Project?</h3>
<p>A directory that is an RStudio Project will contain an <code>.Rproj</code> file. Typically, if the directory is named “foo”, the Project file is <code>foo.Rproj</code>. And if that directory is also an R package, then the package name is usually also “foo”. The path of least resistance is to make all of these names coincide and to NOT nest your package inside a subdirectory inside the Project. If you settle on a different workflow, just know it may feel like you are fighting with the tools.</p>
<p>An <code>.Rproj</code> file is just a text file. Here is a representative project file you might see in a Project initiated via usethis:</p>
<pre><code>Version: 1.0

RestoreWorkspace: No
SaveWorkspace: No
AlwaysSaveHistory: Default

EnableCodeIndexing: Yes
Encoding: UTF-8

AutoAppendNewline: Yes
StripTrailingWhitespace: Yes
LineEndingConversion: Posix

BuildType: Package
PackageUseDevtools: Yes
PackageInstallArgs: --no-multiarch --with-keep.source
PackageRoxygenize: rd,collate,namespace</code></pre>
<p>You don’t need to modify this file by hand. Instead, use the interface available via <em>Tools &gt; Project Options</em> (<a href="#fig-project-options" class="quarto-xref">Figure&nbsp;<span>4.2</span></a>) or <em>Project Options</em> in the Projects menu in the top-right corner (<a href="#fig-projects-menu" class="quarto-xref">Figure&nbsp;<span>4.3</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-project-options" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The Project Options preference page in the RStudio IDE.  On the left side are nine categories: General, Code Editing, R Markdown, Python, Sweave, Spelling, Build Tools, Git/SVN, and Environments. The General category is selected. In the main part of the window are  three options with dropdown boxes:  1. Restore .RData into workspace at startup;  2. Save workspace to .RData on exit; and  3. Always save history (even if not saving .RData).  All three of these options are set to &quot;(Default)&quot;.  There are two options with checkboxes: 1. Disable .Rprofile execution on session start/resume 2. Quit child processes on exit Both of these are unchecked. At the top of the window is the statement:  &quot;Use (Default) to inherit the global default setting&quot;.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-project-options-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/project-options-2.png" class="img-fluid figure-img" alt="The Project Options preference page in the RStudio IDE.  On the left side are nine categories: General, Code Editing, R Markdown, Python, Sweave, Spelling, Build Tools, Git/SVN, and Environments. The General category is selected. In the main part of the window are  three options with dropdown boxes:  1. Restore .RData into workspace at startup;  2. Save workspace to .RData on exit; and  3. Always save history (even if not saving .RData).  All three of these options are set to &quot;(Default)&quot;.  There are two options with checkboxes: 1. Disable .Rprofile execution on session start/resume 2. Quit child processes on exit Both of these are unchecked. At the top of the window is the statement:  &quot;Use (Default) to inherit the global default setting&quot;.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-project-options-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Project Options in RStudio.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-projects-menu" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image of the RStudio IDE Projects drop-down menu, with items:  &quot;New Project...&quot;, &quot;Open Project...&quot;, &quot;Open Project in New Session...&quot;,  &quot;Close Project&quot;, then a list of projects the user has had open   recently, &quot;Close Project&quot;, and &quot;Project Options...&quot;.   The &quot;Project Options...&quot; item is selected.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-projects-menu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/project-options-1.png" class="img-fluid figure-img" style="width:35.0%" alt="Image of the RStudio IDE Projects drop-down menu, with items:  &quot;New Project...&quot;, &quot;Open Project...&quot;, &quot;Open Project in New Session...&quot;,  &quot;Close Project&quot;, then a list of projects the user has had open   recently, &quot;Close Project&quot;, and &quot;Project Options...&quot;.   The &quot;Project Options...&quot; item is selected.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-projects-menu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: Projects Menu in RStudio.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="how-to-launch-an-rstudio-project" class="level3" data-number="4.2.4"><h3 data-number="4.2.4" class="anchored" data-anchor-id="how-to-launch-an-rstudio-project">
<span class="header-section-number">4.2.4</span> How to launch an RStudio Project</h3>
<p>Double-click the <code>foo.Rproj</code> file in macOS’s Finder or Windows Explorer to launch the foo Project in RStudio.</p>
<p>You can also launch Projects from within RStudio via <em>File &gt; Open Project (in New Session)</em> or the Projects menu in the top-right corner.</p>
<p>If you use a productivity or launcher app, you can probably configure it to do something delightful for <code>.Rproj</code> files. We both use Alfred for this <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, which is macOS only, but similar tools exist for Windows. In fact, this is a very good reason to use a productivity app in the first place.</p>
<p>It is very normal – and productive! – to have multiple Projects open at once.</p>
</section><section id="sec-rstudio-project-vs-active-usethis-project" class="level3" data-number="4.2.5"><h3 data-number="4.2.5" class="anchored" data-anchor-id="sec-rstudio-project-vs-active-usethis-project">
<span class="header-section-number">4.2.5</span> RStudio Project vs.&nbsp;active usethis project</h3>
<p>You will notice that most usethis functions don’t take a path: they operate on the files in the “active usethis project”. The usethis package assumes that 95% of the time all of these coincide:</p>
<ul>
<li>The current RStudio Project, if using RStudio.</li>
<li>The active usethis project.</li>
<li>Current working directory for the R process.</li>
</ul>
<p>If things seem funky, call <code>proj_sitrep()</code> to get a “situation report”. This will identify peculiar situations and propose ways to get back to a happier state.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># these should usually be the same (or unset)</span></span>
<span><span class="fu">proj_sitrep</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; *   working_directory: '/Users/jenny/rrr/readxl'</span></span>
<span><span class="co">#&gt; * active_usethis_proj: '/Users/jenny/rrr/readxl'</span></span>
<span><span class="co">#&gt; * active_rstudio_proj: '/Users/jenny/rrr/readxl'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="working-directory-and-filepath-discipline" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="working-directory-and-filepath-discipline">
<span class="header-section-number">4.3</span> Working directory and filepath discipline</h2>
<p>As you develop your package, you will be executing R code. This will be a mix of workflow calls (e.g., <code>document()</code> or <code>test()</code>) and <em>ad hoc</em> calls that help you write your functions, examples, and tests. We <em>strongly recommend</em> that you keep the top-level of your source package as the working directory of your R process. This will generally happen by default, so this is really a recommendation to avoid development workflows that require you to fiddle with working directory.</p>
<p>If you’re totally new to package development, you don’t have much basis for supporting or resisting this proposal. But those with some experience may find this recommendation somewhat upsetting. You may be wondering how you are supposed to express paths when working in subdirectories, such as <code>tests/</code>. As it becomes relevant, we’ll show you how to exploit path-building helpers, such as <code><a href="https://testthat.r-lib.org/reference/test_path.html">testthat::test_path()</a></code>, that determine paths at execution time.</p>
<p>The basic idea is that by leaving working directory alone, you are encouraged to write paths that convey intent explicitly (“read <code>foo.csv</code> from the test directory”) instead of implicitly (“read <code>foo.csv</code> from current working directory, which I <em>think</em> is going to be the test directory”). A sure sign of reliance on implicit paths is incessant fiddling with your working directory, because you’re using <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> to manually fulfill the assumptions that are implicit in your paths.</p>
<p>Using explicit paths can design away a whole class of path headaches and makes day-to-day development more pleasant as well. There are two reasons why implicit paths are hard to get right:</p>
<ul>
<li>Recall the different forms that a package can take during the development cycle (<a href="structure.html" class="quarto-xref"><span>Chapter 3</span></a>). These states differ from each other in terms of which files and folders exist and their relative positions within the hierarchy. It’s tricky to write relative paths that work across all package states.</li>
<li>Eventually, your package will be processed with built-in tools like <code>R CMD build</code>, <code>R CMD check</code>, and <code>R CMD INSTALL</code>, by you and potentially CRAN. It’s hard to keep track of what the working directory will be at every stage of these processes.</li>
</ul>
<p>Path helpers like <code><a href="https://testthat.r-lib.org/reference/test_path.html">testthat::test_path()</a></code>, <code><a href="https://fs.r-lib.org/reference/path_package.html">fs::path_package()</a></code>, and the <a href="https://rprojroot.r-lib.org">rprojroot package</a> are extremely useful for building resilient paths that hold up across the whole range of situations that come up during development and usage. Another way to eliminate brittle paths is to be rigorous in your use of proper methods for storing data inside your package (<a href="data.html" class="quarto-xref"><span>Chapter 7</span></a>) and to target the session temp directory when appropriate, such as for ephemeral testing artefacts (<a href="testing-basics.html" class="quarto-xref"><span>Chapter 13</span></a>).</p>
</section><section id="sec-workflow101-load-all" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="sec-workflow101-load-all">
<span class="header-section-number">4.4</span> Test drive with <code>load_all()</code>
</h2>
<p>The <code>load_all()</code> function is arguably the most important part of the devtools workflow.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># with devtools attached and</span></span>
<span><span class="co"># working directory set to top-level of your source package ...</span></span>
<span></span>
<span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ... now experiment with the functions in your package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>load_all()</code> is the key step in this “lather, rinse, repeat” cycle of package development:</p>
<ol type="1">
<li>Tweak a function definition.</li>
<li><code>load_all()</code></li>
<li>Try out the change by running a small example or some tests.</li>
</ol>
<p>When you’re new to package development or to devtools, it’s easy to overlook the importance of <code>load_all()</code> and fall into some awkward habits from a data analysis workflow.</p>
<section id="benefits-of-load_all" class="level3" data-number="4.4.1"><h3 data-number="4.4.1" class="anchored" data-anchor-id="benefits-of-load_all">
<span class="header-section-number">4.4.1</span> Benefits of <code>load_all()</code>
</h3>
<p>When you first start to use a development environment, like RStudio or VS Code, the biggest win is the ability to send lines of code from an <code>.R</code> script for execution in R console. The fluidity of this is what makes it tolerable to follow the best practice of regarding your source code as real <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> (as opposed to objects in the workspace) and saving <code>.R</code> files (as opposed to saving and reloading <code>.Rdata</code>).</p>
<p><code>load_all()</code> has the same significance for package development and, ironically, requires that you NOT test drive package code in the same way as script code. <code>load_all()</code> <em>simulates</em> the full blown process for seeing the effect of a source code change, which is clunky enough <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> that you won’t want to do it very often. <a href="#fig-load-all" class="quarto-xref">Figure&nbsp;<span>4.4</span></a> reinforces that the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function can only load a package that has been installed, whereas <code>load_all()</code> gives a high-fidelity simulation of this, based on the current package source.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-load-all" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Diagram listing five package states: source, bundle, binary, installed, in memory. Two functions for converting a package from one state to another are depicted. First, `devtools::load_all()` is shown to convert a source package to one that is in memory. Second, `library()` is shown to put an installed package in memory.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-load-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="diagrams/loading.png" class="img-fluid figure-img" alt="Diagram listing five package states: source, bundle, binary, installed, in memory. Two functions for converting a package from one state to another are depicted. First, `devtools::load_all()` is shown to convert a source package to one that is in memory. Second, `library()` is shown to put an installed package in memory.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-load-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: devtools::load_all() vs.&nbsp;library().
</figcaption></figure>
</div>
</div>
</div>
<p>The main benefits of <code>load_all()</code> include:</p>
<ul>
<li>You can iterate quickly, which encourages exploration and incremental progress.
<ul>
<li>This iterative speedup is especially noticeable for packages with compiled code.</li>
</ul>
</li>
<li>You get to develop interactively under a namespace regime that accurately mimics how things are when someone uses your installed package, with the following additional advantages:
<ul>
<li>You can call your own internal functions directly, without using <code>:::</code> and without being tempted to temporarily define your functions in the global workspace.</li>
<li>You can also call functions from other packages that you’ve imported into your <code>NAMESPACE</code>, without being tempted to attach these dependencies via <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>.</li>
</ul>
</li>
</ul>
<p><code>load_all()</code> removes friction from the development workflow and eliminates the temptation to use workarounds that often lead to mistakes around namespace and dependency management.</p>
</section><section id="other-ways-to-call-load_all" class="level3" data-number="4.4.2"><h3 data-number="4.4.2" class="anchored" data-anchor-id="other-ways-to-call-load_all">
<span class="header-section-number">4.4.2</span> Other ways to call <code>load_all()</code>
</h3>
<p>When working in a Project that is a package, RStudio offers several ways to call <code>load_all()</code>:</p>
<ul>
<li>Keyboard shortcut: Cmd+Shift+L (macOS), Ctrl+Shift+L (Windows, Linux)</li>
<li>Build pane’s <em>More …</em> menu</li>
<li><em>Build &gt; Load All</em></li>
</ul>
<p><code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code> is a thin wrapper around <code><a href="https://pkgload.r-lib.org/reference/load_all.html">pkgload::load_all()</a></code> that adds a bit of user-friendliness. It is unlikely you will use <code>load_all()</code> programmatically or inside another package, but if you do, you should probably use <code><a href="https://pkgload.r-lib.org/reference/load_all.html">pkgload::load_all()</a></code> directly.</p>
</section></section><section id="sec-workflow101-r-cmd-check" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="sec-workflow101-r-cmd-check">
<span class="header-section-number">4.5</span> <code>check()</code> and <code>R CMD check</code>
</h2>
<p>Base R provides various command line tools and <code>R CMD check</code> is the official method for checking that an R package is valid. It is essential to pass <code>R CMD check</code> if you plan to submit your package to CRAN, but we <strong>highly recommend</strong> holding yourself to this standard even if you don’t intend to release your package on CRAN. <code>R CMD check</code> detects many common problems that you’d otherwise discover the hard way.</p>
<p>Our recommended way to run <code>R CMD check</code> is in the R console via devtools:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/check.html">check</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We recommend this because it allows you to run <code>R CMD check</code> from within R, which dramatically reduces friction and increases the likelihood that you will <code>check()</code> early and often! This emphasis on fluidity and fast feedback is exactly the same motivation as given for <code>load_all()</code>. In the case of <code>check()</code>, it really is executing <code>R CMD check</code> for you. It’s not just a high fidelity simulation, which is the case for <code>load_all()</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>RStudio exposes <code>check()</code> in the <em>Build</em> menu, in the <em>Build</em> pane via <em>Check</em>, and in keyboard shortcuts Ctrl + Shift + E (Windows &amp; Linux) or Cmd + Shift + E (macOS).</p>
</div>
</div>
<p>A rookie mistake that we see often in new package developers is to do too much work on their package before running <code>R CMD check</code>. Then, when they do finally run it, it’s typical to discover many problems, which can be very demoralizing. It’s counter-intuitive but the key to minimizing this pain is to run <code>R CMD check</code> more often: the sooner you find a problem, the easier it is to fix<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. We model this behaviour very intentionally in <a href="whole-game.html" class="quarto-xref"><span>Chapter 1</span></a>.</p>
<p>The upper limit of this approach is to run <code>R CMD check</code> every time you make a change. We don’t run <code>check()</code> manually quite that often, but when we’re actively working on a package, it’s typical to <code>check()</code> multiple times per day. Don’t tinker with your package for days, weeks, or months, waiting for some special milestone to finally run <code>R CMD check</code>. If you use GitHub (<a href="software-development-practices.html#sec-sw-dev-practices-git-github" class="quarto-xref"><span>Section 20.1</span></a>), we’ll show you how to set things up so that <code>R CMD check</code> runs automatically every time you push (<a href="software-development-practices.html#sec-sw-dev-practices-gha" class="quarto-xref"><span>Section 20.2.1</span></a>).</p>
<section id="check-workflow" class="level3" data-number="4.5.1"><h3 data-number="4.5.1" class="anchored" data-anchor-id="check-workflow">
<span class="header-section-number">4.5.1</span> Workflow</h3>
<p>Here’s what happens inside <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>:</p>
<ul>
<li><p>Ensures that the documentation is up-to-date by running <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code>.</p></li>
<li><p>Bundles the package before checking it (<a href="structure.html#sec-bundled-package" class="quarto-xref"><span>Section 3.3</span></a>). This is the best practice for checking packages because it makes sure the check starts with a clean slate: because a package bundle doesn’t contain any of the temporary files that can accumulate in your source package, e.g.&nbsp;artifacts like <code>.so</code> and <code>.o</code> files which accompany compiled code, you can avoid the spurious warnings such files will generate.</p></li>
<li><p>Sets the <code>NOT_CRAN</code> environment variable to <code>"true"</code>. This allows you to selectively skip tests on CRAN. See <code><a href="https://testthat.r-lib.org/reference/skip.html">?testthat::skip_on_cran</a></code> and <a href="testing-advanced.html#sec-testing-advanced-skip-on-cran" class="quarto-xref"><span>Section 15.4.1</span></a> for details.</p></li>
</ul>
<p>The workflow for checking a package is simple, but tedious:</p>
<ol type="1">
<li><p>Run <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>, or press Ctrl/Cmd + Shift + E.</p></li>
<li><p>Fix the first problem.</p></li>
<li><p>Repeat until there are no more problems.</p></li>
</ol>
<p><code>R CMD check</code> returns three types of messages:</p>
<ul>
<li><p><code>ERROR</code>s: Severe problems that you should fix regardless of whether or not you’re submitting to CRAN.</p></li>
<li><p><code>WARNING</code>s: Likely problems that you must fix if you’re planning to submit to CRAN (and a good idea to look into even if you’re not).</p></li>
<li><p><code>NOTE</code>s: Mild problems or, in a few cases, just an observation. If you are submitting to CRAN, you should strive to eliminate all NOTEs, even if they are false positives. If you have no NOTEs, human intervention is not required, and the package submission process will be easier. If it’s not possible to eliminate a <code>NOTE</code>, you’ll need describe why it’s OK in your submission comments, as described in <a href="release.html#sec-release-process" class="quarto-xref"><span>Section 22.7</span></a>. If you’re not submitting to CRAN, carefully read each NOTE. If it’s easy to eliminate the NOTEs, it’s worth it, so that you can continue to strive for a totally clean result. But if eliminating a NOTE will have a net negative impact on your package, it is reasonable to just tolerate it. Make sure that doesn’t lead to you ignoring other issues that really should be addressed.</p></li>
</ul>
<p><code>R CMD check</code> consists of dozens of individual checks and it would be overwhelming to enumerate them here. See our <a href="https://r-pkgs.org/R-CMD-check.html">online-only guide to <code>R CMD check</code></a> for details.</p>
</section><section id="background-on-r-cmd-check" class="level3" data-number="4.5.2"><h3 data-number="4.5.2" class="anchored" data-anchor-id="background-on-r-cmd-check">
<span class="header-section-number">4.5.2</span> Background on <code>R CMD check</code>
</h3>
<p>As you accumulate package development experience, you might want to access <code>R CMD check</code> directly at some point. Remember that <code>R CMD check</code> is something you must run in the terminal, not in the R console. You can see its documentation like so:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> CMD check <span class="at">--help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>R CMD check</code> can be run on a directory that holds an R package in source form (<a href="structure.html#sec-source-package" class="quarto-xref"><span>Section 3.2</span></a>) or, preferably, on a package bundle (<a href="structure.html#sec-bundled-package" class="quarto-xref"><span>Section 3.3</span></a>):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> CMD build somepackage</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> CMD check somepackage_0.0.0.9000.tar.gz  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To learn more, see the <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Checking-packages">Checking packages</a> section of <a href="https://cran.r-project.org/doc/manuals/R-exts.html">Writing R Extensions</a>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-silge-nash-graves" class="csl-entry" role="listitem">
Silge, Julia, John C. Nash, and Spencer Graves. 2018. <span>“<span class="nocase">Navigating the R Package Universe</span>.”</span> <em><span>The R Journal</span></em> 10 (2): 558–63. <a href="https://doi.org/10.32614/RJ-2018-058">https://doi.org/10.32614/RJ-2018-058</a>.
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Specifically, we configure Alfred to favor <code>.Rproj</code> files in its search results when proposing apps or files to open. To register the <code>.Rproj</code> file type with Alfred, go to <em>Preferences &gt; Features &gt; Default Results &gt; Advanced</em>. Drag any <code>.Rproj</code> file onto this space and then close.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Quoting the usage philosophy favored by <a href="https://ess.r-project.org/Manual/ess.html#Philosophies-for-using-ESS_0028R_0029">Emacs Speaks Statistics</a> (ESS).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The command line approach is to quit R, go to the shell, do <code>R CMD build foo</code> in the package’s parent directory, then <code>R CMD INSTALL foo_x.y.x.tar.gz</code>, restart R, and call <code>library(foo</code>).<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>A great blog post advocating for “if it hurts, do it more often” is <a href="https://martinfowler.com/bliki/FrequencyReducesDifficulty.html">FrequencyReducesDifficulty</a> by Martin Fowler.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/r-pkgs\.org\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./structure.html" class="pagination-link" aria-label="Package structure and state">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./package-within.html" class="pagination-link" aria-label="The package within">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The package within</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/workflow101.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>