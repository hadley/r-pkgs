<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to create a package, the fundamental unit of shareable, reusable, and reproducible R code.">
<title>3&nbsp; Package structure and state – R Packages (2e)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./workflow101.html" rel="next">
<link href="./setup.html" rel="prev">
<link href="./images/cover-2e-small.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8c563c05ac8c1d64e78fdaf2b4701079.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r-pkgs.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./whole-game.html">Getting started</a></li><li class="breadcrumb-item"><a href="./structure.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Packages (2e)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hadley/r-pkgs/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Whole Game</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">System setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structure.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow101.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./package-within.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The package within</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Package components</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Other components</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Package metadata</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><code>DESCRIPTION</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-mindset-background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dependencies: Mindset and Background</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-in-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dependencies: In Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Licensing</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Testing basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Designing your test suite</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Advanced testing techniques</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./man.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vignettes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vignettes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Other markdown files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Website</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Maintenance and distribution</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software-development-practices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Software development practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lifecycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Lifecycle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./release.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Releasing to CRAN</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-CMD-check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-package-states" id="toc-sec-package-states" class="nav-link active" data-scroll-target="#sec-package-states"><span class="header-section-number">3.1</span> Package states</a></li>
  <li><a href="#sec-source-package" id="toc-sec-source-package" class="nav-link" data-scroll-target="#sec-source-package"><span class="header-section-number">3.2</span> Source package</a></li>
  <li>
<a href="#sec-bundled-package" id="toc-sec-bundled-package" class="nav-link" data-scroll-target="#sec-bundled-package"><span class="header-section-number">3.3</span> Bundled package</a>
  <ul class="collapse">
<li><a href="#sec-rbuildignore" id="toc-sec-rbuildignore" class="nav-link" data-scroll-target="#sec-rbuildignore"><span class="header-section-number">3.3.1</span> <code>.Rbuildignore</code></a></li>
  </ul>
</li>
  <li><a href="#sec-structure-binary" id="toc-sec-structure-binary" class="nav-link" data-scroll-target="#sec-structure-binary"><span class="header-section-number">3.4</span> Binary package</a></li>
  <li><a href="#sec-installed-package" id="toc-sec-installed-package" class="nav-link" data-scroll-target="#sec-installed-package"><span class="header-section-number">3.5</span> Installed package</a></li>
  <li><a href="#in-memory-package" id="toc-in-memory-package" class="nav-link" data-scroll-target="#in-memory-package"><span class="header-section-number">3.6</span> In-memory package</a></li>
  <li><a href="#sec-library" id="toc-sec-library" class="nav-link" data-scroll-target="#sec-library"><span class="header-section-number">3.7</span> Package libraries</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/structure.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./whole-game.html">Getting started</a></li><li class="breadcrumb-item"><a href="./structure.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-package-structure-state" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>This chapter will start you on the road to package development by converting the implicit knowledge you’ve gained from <em>using</em> R packages into the explicit knowledge needed to <em>create and modify</em> them. You’ll learn about the various states a package can be in and the difference between a package and library (and why you should care).</p>
<section id="sec-package-states" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="sec-package-states">
<span class="header-section-number">3.1</span> Package states</h2>
<p>When you create or modify a package, you work on its “source code” or “source files”. You interact with the in-development package in its <strong>source</strong> form. This is NOT the package form you are most familiar with from day-to-day usage. Package development workflows make much more sense if you understand the five states an R package can be in:</p>
<ul>
<li>source</li>
<li>bundled</li>
<li>binary</li>
<li>installed</li>
<li>in-memory</li>
</ul>
<p>You already know some of the functions that put packages into these states. For example, <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> can move a package from the source, bundled, or binary states into the installed state. <code><a href="https://remotes.r-lib.org/reference/install_github.html">devtools::install_github()</a></code> takes a source package on GitHub and moves it into the installed state. The <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function loads an installed package into memory, making it available for immediate and direct use.</p>
</section><section id="sec-source-package" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="sec-source-package">
<span class="header-section-number">3.2</span> Source package</h2>
<p>A <strong>source</strong> package is just a directory of files with a specific structure. It includes particular components, such as a <code>DESCRIPTION</code> file, an <code>R/</code> directory containing <code>.R</code> files, and so on. Most of the remaining chapters in this book are dedicated to detailing these components.</p>
<p>If you are new to package development, you may have never seen a package in source form! You might not even have any source packages on your computer. The easiest way to see a package in source form right away is to browse around its code on the web.</p>
<p>Many R packages are developed in the open on GitHub (or GitLab or similar). The best case scenario is that you visit the package’s CRAN landing page, e.g.:</p>
<ul>
<li>forcats: <a href="https://cran.r-project.org/package=forcats" class="uri">https://cran.r-project.org/package=forcats</a>
</li>
<li>readxl: <a href="https://cran.r-project.org/package=readxl" class="uri">https://cran.r-project.org/package=readxl</a>
</li>
</ul>
<p>and one of its URLs links to a repository on a public hosting service, e.g.:</p>
<ul>
<li>forcats: <a href="https://github.com/tidyverse/forcats" class="uri">https://github.com/tidyverse/forcats</a>
</li>
<li>readxl: <a href="https://github.com/tidyverse/readxl" class="uri">https://github.com/tidyverse/readxl</a>
</li>
</ul>
<p>Some maintainers forget to list this URL, even though the package is developed in a public repository, but you still might be able to discover it via search.</p>
<p>Even if a package is not developed on a public platform, you can visit its source in the <a href="https://docs.r-hub.io/#cranatgh">unofficial, read-only mirror maintained by R-hub</a>. Examples:</p>
<ul>
<li>MASS: <a href="https://github.com/cran/MASS" class="uri">https://github.com/cran/MASS</a>
</li>
<li>car: <a href="https://github.com/cran/car" class="uri">https://github.com/cran/car</a>
</li>
</ul>
<p>Note that exploring a package’s source and history within the <code>cran</code> GitHub organisation is not the same as exploring the package’s true development venue, because this source and its evolution is just reverse-engineered from the package’s CRAN releases. This presents a redacted view of the package and its history, but, by definition, it includes everything that is essential.</p>
</section><section id="sec-bundled-package" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="sec-bundled-package">
<span class="header-section-number">3.3</span> Bundled package</h2>
<p>A <strong>bundled</strong> package is a package that’s been compressed into a single file. By convention (from Linux), package bundles in R use the extension <code>.tar.gz</code> and are sometimes referred to as “source tarballs”. This means that multiple files have been reduced to a single file (<code>.tar</code>) and then compressed using gzip (<code>.gz</code>). While a bundle is not that useful on its own, it’s a platform-agnostic, transportation-friendly intermediary between a source package and an installed package.</p>
<p>In the rare case that you need to make a bundle from a package you’re developing locally, use <code><a href="https://devtools.r-lib.org/reference/build.html">devtools::build()</a></code>. Under the hood, this calls <code><a href="https://pkgbuild.r-lib.org/reference/build.html">pkgbuild::build()</a></code> and, ultimately, <code>R CMD build</code>, which is described further in the <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Building-package-tarballs">Building package tarballs</a> section of <a href="https://cran.r-project.org/doc/manuals/R-exts.html">Writing R Extensions</a>.</p>
<p>This should tip you off that a package bundle or “source tarball” is not simply the result of making a tar archive of the source files, then compressing with gzip. By convention, in the R world, a few more operations are carried out when making the <code>.tar.gz</code> file and this is why we’ve elected to refer to this form as a package <strong>bundle</strong>, in this book.</p>
<p>Every CRAN package is available in bundled form, via the “Package source” field of its landing page. Continuing our examples from above, you could download the bundles <code>forcats_0.4.0.tar.gz</code> and <code>readxl_1.3.1.tar.gz</code> (or whatever the current versions may be). You could unpack such a bundle in the shell (not the R console) like so:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> xvf forcats_0.4.0.tar.gz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you decompress a bundle, you’ll see it looks almost the same as a source package. <a href="#fig-package-files" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> shows the files present in the source, bundled, and binary forms of a fictional package named zzzpackage. We’ve deliberately crafted this example to include most of the package parts covered in this book. Not every package will include every file seen here, nor does this diagram include every possible file that might appear in a package.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-package-files" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Side-by-side comparison of source, bundled, and binary package.  The flow of files (location and format) from package source to  bundled to binary state is shown. This is described in detail in the appropriately named sections of this chapter.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-package-files-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="diagrams/package-files.png" class="img-fluid figure-img" alt="Side-by-side comparison of source, bundled, and binary package.  The flow of files (location and format) from package source to  bundled to binary state is shown. This is described in detail in the appropriately named sections of this chapter.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-package-files-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Package forms: source vs.&nbsp;bundled vs.&nbsp;binary.
</figcaption></figure>
</div>
</div>
</div>
<p>The main differences between a source package and an uncompressed bundle are:</p>
<ul>
<li><p>Vignettes have been built, so rendered outputs, such as HTML, appear below <code>inst/doc/</code> and a vignette index appears in the <code>build/</code> directory.</p></li>
<li><p>A local source package might contain temporary files used to save time during development, like compilation artefacts in <code>src/</code>. These are never found in a bundle.</p></li>
<li><p>Any files listed in <code>.Rbuildignore</code> are not included in the bundle. These are typically files that facilitate your development process, but that should be excluded from the distributed product.</p></li>
</ul>
<section id="sec-rbuildignore" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-rbuildignore">
<span class="header-section-number">3.3.1</span> <code>.Rbuildignore</code>
</h3>
<p>You won’t need to contemplate the exact structure of package <code>.tar.gz</code> files very often, but you do need to understand the <code>.Rbuildignore</code> file. It controls which files from the source package make it into the downstream forms.</p>
<p>Each line of <code>.Rbuildignore</code> is a Perl-compatible regular expression that is matched, without regard to case, against the path to each file in the source package<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. If the regular expression matches, that file or directory is excluded. Note there are some default exclusions implemented by R itself, mostly relating to classic version control systems and editors, such as SVN, Git, and Emacs.</p>
<p>We usually modify <code>.Rbuildignore</code> with the <code><a href="https://usethis.r-lib.org/reference/use_build_ignore.html">usethis::use_build_ignore()</a></code> function, which takes care of easy-to-forget details, such as regular expression anchoring and escaping. To exclude a specific file or directory (the most common use case), you <strong>MUST</strong> anchor the regular expression. For example, to exclude a directory called “notes”, the <code>.Rbuildignore</code> entry must be <code>^notes$</code>, whereas the unanchored regular expression <code>notes</code> will match any file name containing “notes”, e.g. <code>R/notes.R</code>, <code>man/important-notes.R</code>, <code>data/endnotes.Rdata</code>, etc. We find that <code><a href="https://usethis.r-lib.org/reference/use_build_ignore.html">use_build_ignore()</a></code> helps us get more of our <code>.Rbuildignore</code> entries right the first time.</p>
<p><code>.Rbuildignore</code> is a way to resolve some of the tension between the practices that support your development process and CRAN’s requirements for submission and distribution (<a href="release.html" class="quarto-xref"><span>Chapter 22</span></a>). Even if you aren’t planning to release on CRAN, following these conventions will allow you to make the best use of R’s built-in tooling for package checking and installation. The files you should <code>.Rbuildignore</code> fall into two broad, semi-overlapping classes:</p>
<ul>
<li>Files that help you generate package contents programmatically. Examples:
<ul>
<li>Using <code>README.Rmd</code> to generate an informative and current <code>README.md</code> (<a href="other-markdown.html#sec-readme" class="quarto-xref"><span>Section 18.1</span></a>).</li>
<li>Storing <code>.R</code> scripts to create and update internal or exported data (<a href="data.html#sec-data-data-raw" class="quarto-xref"><span>Section 7.1.1</span></a>).</li>
</ul>
</li>
<li>Files that drive package development, checking, and documentation, outside of CRAN’s purview. Examples:
<ul>
<li>Files relating to the RStudio IDE (<a href="workflow101.html#sec-workflow101-rstudio-projects" class="quarto-xref"><span>Section 4.2</span></a>).</li>
<li>Using the <a href="https://pkgdown.r-lib.org">pkgdown package</a> to generate a website (<a href="website.html" class="quarto-xref"><span>Chapter 19</span></a>).</li>
<li>Configuration files related to continuous integration/deployment (<a href="software-development-practices.html#sec-sw-dev-practices-ci" class="quarto-xref"><span>Section 20.2</span></a>).</li>
</ul>
</li>
</ul>
<p>Here is a non-exhaustive list of typical entries in the <code>.Rbuildignore</code> file for a package in the tidyverse:</p>
<pre><code>^.*\.Rproj$         # Designates the directory as an RStudio Project
^\.Rproj\.user$     # Used by RStudio for temporary files
^README\.Rmd$       # An Rmd file used to generate README.md
^LICENSE\.md$       # Full text of the license
^cran-comments\.md$ # Comments for CRAN submission
^data-raw$          # Code used to create data included in the package
^pkgdown$           # Resources used for the package website
^_pkgdown\.yml$     # Configuration info for the package website
^\.github$          # GitHub Actions workflows</code></pre>
<p>Note that the comments above must not appear in an actual <code>.Rbuildignore</code> file; they are included here only for exposition.</p>
<p>We’ll mention when you need to add files to <code>.Rbuildignore</code> whenever it’s important. Remember that <code><a href="https://usethis.r-lib.org/reference/use_build_ignore.html">usethis::use_build_ignore()</a></code> is an attractive way to manage this file. Furthermore, many usethis functions that add a file that should be listed in <code>.Rbuildignore</code> take care of this automatically. For example, <code><a href="https://usethis.r-lib.org/reference/use_readme_rmd.html">use_readme_rmd()</a></code> adds “^README\.Rmd$” to <code>.Rbuildignore</code>.</p>
</section></section><section id="sec-structure-binary" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="sec-structure-binary">
<span class="header-section-number">3.4</span> Binary package</h2>
<p>If you want to distribute your package to an R user who doesn’t have package development tools, you’ll need to provide a <strong>binary</strong> package. The primary maker and distributor of binary packages is CRAN, not individual maintainers. But even if you delegate the responsibility of distributing your package to CRAN, it’s still important for a maintainer to understand the nature of a binary package.</p>
<p>Like a package bundle, a binary package is a single file. Unlike a bundled package, a binary package is platform specific and there are two basic flavors: Windows and macOS. (Linux users are generally required to have the tools necessary to install from <code>.tar.gz</code> files, although the emergence of resources like <a href="https://packagemanager.posit.co/">Posit Public Package Manager</a> is giving Linux users the same access to binary packages as their colleagues on Windows and macOS.)</p>
<p>Binary packages for macOS are stored as <code>.tgz</code>, whereas Windows binary packages end in <code>.zip</code>. If you need to make a binary package, use <code>devtools::build(binary = TRUE)</code> on the relevant operating system. Under the hood, this calls <code>pkgbuild::build(binary = TRUE)</code> and, ultimately, <code>R CMD INSTALL --build</code>, which is described further in the <a href="https://cran.r-project.org/doc/manuals/R-exts.html#Building-binary-packages">Building binary packages</a> section of <a href="https://cran.r-project.org/doc/manuals/R-exts.html">Writing R Extensions</a>. If you choose to release your package on CRAN (<a href="release.html" class="quarto-xref"><span>Chapter 22</span></a>), you submit your package in bundled form, then CRAN creates and distributes the package binaries.</p>
<p>CRAN packages are usually available in binary form, for both macOS and Windows, for the current, previous, and (possibly) development versions of R. Continuing our examples from above, you could download binary packages such as:</p>
<ul>
<li>forcats for macOS: <code>forcats_0.4.0.tgz</code>
</li>
<li>readxl for Windows: <code>readxl_1.3.1.zip</code>
</li>
</ul>
<p>and this is, indeed, part of what’s usually going on behind the scenes when you call <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>.</p>
<p>If you uncompress a binary package, you’ll see that the internal structure is rather different from a source or bundled package. <a href="#fig-package-files" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> includes this comparison, so this is a good time to revisit that diagram. Here are some of the most notable differences:</p>
<ul>
<li><p>There are no <code>.R</code> files in the <code>R/</code> directory - instead there are three files that store the parsed functions in an efficient file format. This is basically the result of loading all the R code and then saving the functions with <code><a href="https://rdrr.io/r/base/save.html">save()</a></code>. (In the process, this adds a little extra metadata to make things as fast as possible).</p></li>
<li><p>A <code>Meta/</code> directory contains a number of <code>.rds</code> files. These files contain cached metadata about the package, like what topics the help files cover and a parsed version of the <code>DESCRIPTION</code> file. (You can use <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code> to see exactly what’s in those files). These files make package loading faster by caching costly computations.</p></li>
<li><p>The actual help content appears in <code>help/</code> and <code>html/</code> (no longer in <code>man/</code>).</p></li>
<li><p>If you had any code in the <code>src/</code> directory, there will now be a <code>libs/</code> directory that contains the results of compiling the code.</p></li>
<li><p>If you had any objects in <code>data/</code>, they have now been converted into a more efficient form.</p></li>
<li><p>The contents of <code>inst/</code> are moved to the top-level directory. For example, vignette files are now in <code>doc/</code>.</p></li>
<li><p>Some files and folders have been dropped, such as <code>README.md</code>, <code>build/</code>, <code>tests/</code>, and <code>vignettes/</code>.</p></li>
</ul></section><section id="sec-installed-package" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="sec-installed-package">
<span class="header-section-number">3.5</span> Installed package</h2>
<p>An <strong>installed</strong> package is a binary package that’s been decompressed into a package library (described in <a href="#sec-library" class="quarto-xref"><span>Section 3.7</span></a>). <a href="#fig-installation" class="quarto-xref">Figure&nbsp;<span>3.2</span></a> illustrates the many ways a package can be installed, along with a few other functions for converting a package from one state to another. This diagram is complicated! In an ideal world, installing a package would involve stringing together a set of simple steps: source -&gt; bundle, bundle -&gt; binary, binary -&gt; installed. In the real world, it’s not this simple because there are often (faster) shortcuts available.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-installation" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A chart showing different ways to go from one package state to another: 1. library() puts an installed package into memory. 2. Functions such as install.packages(),    devtools::install_github(), and devtools::install()    can install a package starting variously in the source,    bundle, or binary forms. 3. devtools::build() can create a bundle or a binary. 4. devtools::load_all() puts a source package into memory.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-installation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="diagrams/install-load.png" class="img-fluid figure-img" alt="A chart showing different ways to go from one package state to another: 1. library() puts an installed package into memory. 2. Functions such as install.packages(),    devtools::install_github(), and devtools::install()    can install a package starting variously in the source,    bundle, or binary forms. 3. devtools::build() can create a bundle or a binary. 4. devtools::load_all() puts a source package into memory.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-installation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Many methods for converting between package states.
</figcaption></figure>
</div>
</div>
</div>
<p>The built-in command line tool <code>R CMD INSTALL</code> powers all package installation. It can install a package from source files, a bundle (a.k.a. a source tarball), or a binary package. Details are available in the <a href="https://cran.r-project.org/doc/manuals/R-admin.html#Installing-packages">Installing packages section</a> of <a href="https://cran.r-project.org/doc/manuals/R-admin.html">R Installation and Administration</a>. Just like with <code><a href="https://devtools.r-lib.org/reference/build.html">devtools::build()</a></code>, devtools provides a wrapper function, <code><a href="https://devtools.r-lib.org/reference/install.html">devtools::install()</a></code>, that makes this tool available from within an R session.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>RStudio can also help you install your in-development package via the <em>Install</em> and <em>More</em> drop-downs in the <em>Build</em> pane and with <em>Install Package</em> in the <em>Build</em> menu.</p>
</div>
</div>
<p>Most useRs understandably like to install packages from the comfort of an R session and directly from CRAN. The built-in function <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> meets this need. It can download the package, in various forms, install it, and optionally attend to the installation of dependencies.</p>
<p>There is a price, however, for the convenience of installing R packages from within an R session. As you might expect, it can be a bit tricky to re-install a package that is already in use in the current session. This actually works most of the time, but sometimes it does not, especially when installing an R package with compiled code on Windows. Due to how file handles are locked on Windows, an attempt to install a new version of a package that’s in use can result in a corrupt installation where the package’s R code has been updated, but its compiled code has not. When troubleshooting, Windows users should strive to install packages in a clean R session, with as few packages loaded as possible.</p>
<p>The pak package (<a href="https://pak.r-lib.org/" class="uri">https://pak.r-lib.org/</a>) is a relative newcomer (at the time of writing) and provides a promising alternative to <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>, as well as other more specialized functions such as <code><a href="https://remotes.r-lib.org/reference/install_github.html">devtools::install_github()</a></code>. It’s too early to make a blanket recommendation for using pak for all of your package installation needs, but we are certainly using it more and more in our personal workflows. One of pak’s flagship features is that it nicely solves the “locked DLL” problem described above, i.e.&nbsp;updating a package with compiled code on Windows. As you get deeper into package development, you will find yourself doing a whole new set of tasks, such as installing a dependency from an in-development branch or scrutinizing package dependency trees. pak provides a rich toolkit for this and many other related tasks. We predict that pak will soon become our official recommendation for how to install packages (and more).</p>
<p>However, in the meantime, we describe the <em>status quo</em>. devtools has long offered a family of <code>install_*()</code> functions to address some needs beyond the reach of <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> or to make existing capabilities easier to access. These functions are actually maintained in the <a href="https://remotes.r-lib.org">remotes package</a> and are re-exported by devtools. (Given what we said above, it is likely that remotes will essentially become superseded, in favor of pak, but we’re not quite there yet.)</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org">remotes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">funs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/ls_str.html">lsf.str</a></span><span class="op">(</span><span class="st">"package:remotes"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"^install_.+"</span>, <span class="va">funs</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "install_bioc"      "install_bitbucket" "install_cran"     </span></span>
<span><span class="co">#&gt;  [4] "install_deps"      "install_dev"       "install_git"      </span></span>
<span><span class="co">#&gt;  [7] "install_github"    "install_gitlab"    "install_local"    </span></span>
<span><span class="co">#&gt; [10] "install_remote"    "install_svn"       "install_url"      </span></span>
<span><span class="co">#&gt; [13] "install_version"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://remotes.r-lib.org/reference/install_github.html">install_github()</a></code> is the most useful of these functions and is also featured in <a href="#fig-installation" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>. It is the flagship example of a family of functions that can download a package from a remote location that is not CRAN and do whatever is necessary to install it and its dependencies. The rest of the devtools/remotes <code>install_*()</code> functions are aimed at making things that are technically possible with base tooling a bit easier or more explicit, such as <code><a href="https://remotes.r-lib.org/reference/install_version.html">install_version()</a></code> which installs a specific version of a CRAN package.</p>
<p>Analogous to <code>.Rbuildignore</code>, described in section <a href="#sec-rbuildignore" class="quarto-xref"><span>Section 3.3.1</span></a>, <code>.Rinstignore</code> lets you keep files present in a package bundle out of the installed package. However, in contrast to <code>.Rbuildignore</code>, this is rather obscure and rarely needed.</p>
</section><section id="in-memory-package" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="in-memory-package">
<span class="header-section-number">3.6</span> In-memory package</h2>
<p>We finally arrive at a command familiar to everyone who uses R:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org">usethis</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Assuming usethis is installed, this call makes its functions available for use, i.e.&nbsp;now we can do:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_package.html">create_package</a></span><span class="op">(</span><span class="st">"/path/to/my/coolpackage"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The usethis package has been loaded into memory and, in fact, has also been attached to the search path. The distinction between loading and attaching packages is not important when you’re writing scripts, but it’s very important when you’re writing packages. You’ll learn more about the difference and why it’s important in <a href="dependencies-mindset-background.html#sec-dependencies-attach-vs-load" class="quarto-xref"><span>Section 10.4</span></a>.</p>
<p><code><a href="https://rdrr.io/r/base/library.html">library()</a></code> is not a great way to iteratively tweak and test drive a package you’re developing, because it only works for an installed package. In <a href="workflow101.html#sec-workflow101-load-all" class="quarto-xref"><span>Section 4.4</span></a>, you’ll learn how <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code> accelerates development by allowing you to load a source package directly into memory.</p>
</section><section id="sec-library" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="sec-library">
<span class="header-section-number">3.7</span> Package libraries</h2>
<p>We just discussed the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function, whose name is inspired by what it does. When you call <code><a href="https://rdrr.io/r/base/library.html">library(somepackage)</a></code>, R looks through the current <strong>libraries</strong> for an installed package named “somepackage” and, if successful, it makes somepackage available for use.</p>
<p>In R, a <strong>library</strong> is a directory containing installed packages, sort of like a library for books. Unfortunately, in the R world, you will frequently encounter confused usage of the words “library” and “package”. It’s common for someone to refer to dplyr, for example, as a library when it is actually a package. There are a few reasons for the confusion. First, R’s terminology arguably runs counter to broader programming conventions, where the usual meaning of “library” is closer to what we mean by “package”. The name of the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function itself probably reinforces the wrong associations. Finally, this vocabulary error is often harmless, so it’s easy for R users to fall into the wrong habit and for people who point out this mistake to look like insufferable pedants. But here’s the bottom line:</p>
<blockquote class="blockquote">
<p>We use the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function to load <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> a <strong>package</strong>.</p>
</blockquote>
<p>The distinction between the two is important and useful as you get involved in package development.</p>
<p>You can have multiple libraries on your computer. In fact, many of you already do, especially if you’re on Windows. You can use <code><a href="https://rdrr.io/r/base/libPaths.html">.libPaths()</a></code> to see which libraries are currently active. Here’s how this might look on Windows:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># on Windows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "C:/Users/jenny/AppData/Local/R/win-library/4.2"</span></span>
<span><span class="co">#&gt; [2] "C:/Program Files/R/R-4.2.2/library"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">list.dirs</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span>, full.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;   [1] "abc"           "anytime"       "askpass"       "assertthat"   </span></span>
<span><span class="co">#&gt;  ...</span></span>
<span><span class="co">#&gt; [145] "zeallot"      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;  [1] "base"         "boot"         "class"        "cluster"     </span></span>
<span><span class="co">#&gt;  [5] "codetools"    "compiler"     "datasets"     "foreign"     </span></span>
<span><span class="co">#&gt;  [9] "graphics"     "grDevices"    "grid"         "KernSmooth"  </span></span>
<span><span class="co">#&gt; [13] "lattice"      "MASS"         "Matrix"       "methods"     </span></span>
<span><span class="co">#&gt; [17] "mgcv"         "nlme"         "nnet"         "parallel"    </span></span>
<span><span class="co">#&gt; [21] "rpart"        "spatial"      "splines"      "stats"       </span></span>
<span><span class="co">#&gt; [25] "stats4"       "survival"     "tcltk"        "tools"       </span></span>
<span><span class="co">#&gt; [29] "translations" "utils"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s a similar look on macOS (but your results may vary):</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># on macOS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/Users/jenny/Library/R/arm64/4.2/library"</span></span>
<span><span class="co">#&gt; [2] "/Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">list.dirs</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span>, full.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;    [1] "abc"                  "abc.data"             "abind"                </span></span>
<span><span class="co">#&gt;  ...</span></span>
<span><span class="co">#&gt; [1033] "Zelig"                "zip"                  "zoo"                 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;  [1] "base"         "boot"         "class"        "cluster"     </span></span>
<span><span class="co">#&gt;  [5] "codetools"    "compiler"     "datasets"     "foreign"     </span></span>
<span><span class="co">#&gt;  [9] "graphics"     "grDevices"    "grid"         "KernSmooth"  </span></span>
<span><span class="co">#&gt; [13] "lattice"      "MASS"         "Matrix"       "methods"     </span></span>
<span><span class="co">#&gt; [17] "mgcv"         "nlme"         "nnet"         "parallel"    </span></span>
<span><span class="co">#&gt; [21] "rpart"        "spatial"      "splines"      "stats"       </span></span>
<span><span class="co">#&gt; [25] "stats4"       "survival"     "tcltk"        "tools"       </span></span>
<span><span class="co">#&gt; [29] "translations" "utils"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In both cases we see two active libraries, consulted in this order:</p>
<ol type="1">
<li>A user library</li>
<li>A system-level or global library</li>
</ol>
<p>This setup is typical on Windows, but is something you usually need to opt into on macOS and Linux<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. With this setup, add-on packages installed from CRAN (or elsewhere) or under local development are kept in the user library. Above, the macOS system is used as a primary development machine and has many packages here (~1000), whereas the Windows system is only used occasionally and is much more spartan. The core set of base and recommended packages that ship with R live in the system-level library and are the same on all operating systems. This separation appeals to many developers and makes it easy to, for example, clean out your add-on packages without disturbing your base R installation.</p>
<p>If you’re on macOS or Linux and only see one library, there is no urgent need to change anything. But next time you upgrade R, consider creating a user-level library. By default, R looks for a user library found at the path stored in the environment variable <code>R_LIBS_USER</code>, which itself defaults to <code>~/Library/R/m/x.y/library,</code> on macOS, and <code>~/R/m-library/x.y</code> on Linux (where <code>m</code> is a concise description of your CPU architecture, and <code>x.y</code> is the R version). You can see this path with <code>Sys.getenv("R_LIBS_USER")</code>. These directories do not exist by default, and the use of them must be enabled by creating the directory. When you install a new version of R, and prior to installing any add-on packages, use <code>dir.create(Sys.getenv("R_LIBS_USER"), recursive = TRUE)</code> to create a user library in the default location. Now you will have the library setup seen above. Alternatively, you could set up a user library elsewhere and tell R about that by setting the <code>R_LIBS_USER</code> environment variable in <code>.Renviron</code>. The simplest way to edit your <code>.Renviron</code> file is with <code><a href="https://usethis.r-lib.org/reference/edit.html">usethis::edit_r_environ()</a></code>, which will create the file if it doesn’t exist, and open it for editing.</p>
<p>The filepaths for these libraries also make it clear they are associated with a specific version of R (4.2.x at the time of writing), which is also typical. This reflects and enforces the fact that you need to reinstall your add-on packages when you update R from, say, 4.1 to 4.2, which is a change in the <strong>minor</strong> version. You generally do not need to re-install add-on packages for a <strong>patch</strong> release, e.g., going from R 4.2.1 to 4.2.2.</p>
<p>As your R usage grows more sophisticated, it’s common to start managing package libraries with more intention. For example, tools like <a href="https://rstudio.github.io/renv/">renv</a> (and its predecessor <a href="https://rstudio.github.io/packrat/">packrat</a>) automate the process of managing project-specific libraries. This can be important for making data products reproducible, portable, and isolated from one another. A package developer might prepend the library search path with a temporary library, containing a set of packages at specific versions, in order to explore issues with backwards and forwards compatibility, without affecting other day-to-day work. Reverse dependency checks are another example where we explicitly manage the library search path.</p>
<p>Here are the main levers that control which libraries are active, in order of scope and persistence:</p>
<ul>
<li>Environment variables, like <code>R_LIBS</code> and <code>R_LIBS_USER</code>, which are consulted at startup.</li>
<li>Calling <code><a href="https://rdrr.io/r/base/libPaths.html">.libPaths()</a></code> with one or more filepaths.</li>
<li>Executing small snippets of code with a temporarily altered library search path via <code><a href="https://withr.r-lib.org/reference/with_libpaths.html">withr::with_libpaths()</a></code>.</li>
<li>Arguments to individual functions, like <code>install.packages(lib =)</code> and <code><a href="https://rdrr.io/r/base/library.html">library(lib.loc =)</a></code>.</li>
</ul>
<p>Finally, it’s important to note that <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> should NEVER be used <em>inside a package</em>. Packages and scripts rely on different mechanisms for declaring their dependencies and this is one of the biggest adjustments you need to make in your mental model and habits. We explore this topic fully in <a href="description.html#sec-description-imports-suggests" class="quarto-xref"><span>Section 9.6</span></a> and <a href="dependencies-in-practice.html" class="quarto-xref"><span>Chapter 11</span></a>.</p>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>To see the set of filepaths that should be on your radar, execute <code>dir(full.names = TRUE, recursive = TRUE, include.dirs = TRUE, all.files = TRUE)</code> in the package’s top-level directory.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Well, actually, <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> loads and attaches a package, but that’s a topic for <a href="dependencies-mindset-background.html#sec-dependencies-attach-vs-load" class="quarto-xref"><span>Section 10.4</span></a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>For more details, see the <a href="https://rstats.wtf/maintaining-r#how-to-transfer-your-library-when-updating-r">Maintaining R section</a> in <em>What They Forgot To Teach You About R</em>, <a href="https://rstudio.github.io/r-manuals/r-admin/Add-on-packages.html#managing-libraries">Managing Libraries</a> in <em>R Installation and Administration</em> and the R help files for <code><a href="https://rdrr.io/r/base/Startup.html">?Startup</a></code> and <code><a href="https://rdrr.io/r/base/libPaths.html">?.libPaths</a></code>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/r-pkgs\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./setup.html" class="pagination-link" aria-label="System setup">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">System setup</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./workflow101.html" class="pagination-link" aria-label="Fundamental development workflows">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/structure.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>