<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to create a package, the fundamental unit of shareable, reusable, and reproducible R code.">
<title>Appendix A — R CMD check – R Packages (2e)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="prev">
<link href="./images/cover-2e-small.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8c563c05ac8c1d64e78fdaf2b4701079.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r-pkgs.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./R-CMD-check.html">Appendices</a></li><li class="breadcrumb-item"><a href="./R-CMD-check.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Packages (2e)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hadley/r-pkgs/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Whole Game</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">System setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package structure and state</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow101.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./package-within.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The package within</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Package components</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Other components</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Package metadata</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><code>DESCRIPTION</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-mindset-background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dependencies: Mindset and Background</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-in-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dependencies: In Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Licensing</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Testing basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Designing your test suite</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Advanced testing techniques</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./man.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Function documentation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vignettes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vignettes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Other markdown files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Website</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Maintenance and distribution</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software-development-practices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Software development practices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lifecycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Lifecycle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./release.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Releasing to CRAN</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-CMD-check.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#check-metadata" id="toc-check-metadata" class="nav-link active" data-scroll-target="#check-metadata"><span class="header-section-number">A.1</span> Check metadata</a></li>
  <li><a href="#package-structure" id="toc-package-structure" class="nav-link" data-scroll-target="#package-structure"><span class="header-section-number">A.2</span> Package structure</a></li>
  <li><a href="#description" id="toc-description" class="nav-link" data-scroll-target="#description"><span class="header-section-number">A.3</span> <code>DESCRIPTION</code></a></li>
  <li><a href="#namespace" id="toc-namespace" class="nav-link" data-scroll-target="#namespace"><span class="header-section-number">A.4</span> Namespace</a></li>
  <li><a href="#r-code" id="toc-r-code" class="nav-link" data-scroll-target="#r-code"><span class="header-section-number">A.5</span> R code</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">A.6</span> Data</a></li>
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation"><span class="header-section-number">A.7</span> Documentation</a></li>
  <li><a href="#demos" id="toc-demos" class="nav-link" data-scroll-target="#demos"><span class="header-section-number">A.8</span> Demos</a></li>
  <li><a href="#compiled-code" id="toc-compiled-code" class="nav-link" data-scroll-target="#compiled-code"><span class="header-section-number">A.9</span> Compiled code</a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests"><span class="header-section-number">A.10</span> Tests</a></li>
  <li><a href="#vignettes" id="toc-vignettes" class="nav-link" data-scroll-target="#vignettes"><span class="header-section-number">A.11</span> Vignettes</a></li>
  <li>
<a href="#sec-r-cmd-check-informational-notes" id="toc-sec-r-cmd-check-informational-notes" class="nav-link" data-scroll-target="#sec-r-cmd-check-informational-notes"><span class="header-section-number">A.12</span> NOTEs that are informational</a>
  <ul class="collapse">
<li><a href="#initial-cran-submission" id="toc-initial-cran-submission" class="nav-link" data-scroll-target="#initial-cran-submission"><span class="header-section-number">A.12.1</span> Initial CRAN submission</a></li>
  <li><a href="#non-ascii-characters-in-data" id="toc-non-ascii-characters-in-data" class="nav-link" data-scroll-target="#non-ascii-characters-in-data"><span class="header-section-number">A.12.2</span> Non-ASCII characters in data</a></li>
  <li><a href="#rd-cross-references" id="toc-rd-cross-references" class="nav-link" data-scroll-target="#rd-cross-references"><span class="header-section-number">A.12.3</span> Rd cross-references</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/R-CMD-check.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./R-CMD-check.html">Appendices</a></li><li class="breadcrumb-item"><a href="./R-CMD-check.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-r-cmd-check" class="quarto-section-identifier">Appendix A — <code>R CMD check</code></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><code>R CMD check</code> is composed of over 50 individual checks, described in the following sections. For each check, we briefly describe what it does, what the most common problems are, and how to fix them. When you have a problem with <code>R CMD check</code> and can’t understand how to fix it, use this list to help figure out what you need to do. To make it easier to understand how the checks fit together, we’ve organised them into sections roughly corresponding to the chapters in this book. This means they will be in a somewhat different order to what you’ll see when you run <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>, which is our main way of running <code>R CMD check</code>.</p>
<p>If this chapter doesn’t match up with what you’re seeing, consider that the checks may have changed since this was written. R continues to evolve, including <code>R CMD check</code>. You may want to consult the most recent online version of this chapter: <a href="https://r-pkgs.org/r-cmd-check.html" class="uri">https://r-pkgs.org/r-cmd-check.html</a>. Please <a href="https://github.com/hadley/r-pkgs/issues/new">open an issue</a> if you encounter a problem that this chapter doesn’t help with.</p>
<p>At the very end (<a href="#sec-r-cmd-check-informational-notes" class="quarto-xref"><span>Section A.12</span></a>), we highlight some NOTEs that arise during <code>R CMD check</code> that don’t require any response from you. In general, we recommend eliminating all NOTEs, especially for packages destined for CRAN, but there are a small handful of NOTEs that truly are informational. They are the exception to the rule.</p>
<section id="check-metadata" class="level2" data-number="A.1"><h2 data-number="A.1" class="anchored" data-anchor-id="check-metadata">
<span class="header-section-number">A.1</span> Check metadata</h2>
<p><code>R CMD check</code> always starts by describing your current environment.</p>
<ul>
<li>
<strong>Using log directory</strong> ‘/some/tmp/path/googledrive.Rcheck’</li>
<li>
<strong>Using R version</strong> 4.2.2 (2022-10-31)</li>
<li>
<strong>Using platform</strong>: x86_64-apple-darwin17.0 (64-bit)</li>
<li>
<strong>Using session charset</strong>: UTF-8</li>
</ul>
<p>Next the <code>DESCRIPTION</code> file is parsed and the package version and encoding is printed.</p>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3459 -->
<ul>
<li>
<strong>Checking for file</strong> ‘googledrive/DESCRIPTION’</li>
<li>
<strong>This is package</strong> ‘googledrive’ version ‘2.1.0.9000’</li>
<li>
<strong>Package encoding</strong>: UTF-8</li>
</ul></section><section id="package-structure" class="level2" data-number="A.2"><h2 data-number="A.2" class="anchored" data-anchor-id="package-structure">
<span class="header-section-number">A.2</span> Package structure</h2>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L257 -->
<ul>
<li>
<strong>Checking package directory</strong>. The directory you’re checking must exist - <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code> protects you against this problem.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3720 --><ul>
<li>
<strong>Checking if this is a source package</strong>. You must check a source package, not a binary or installed package. This should never fail if you use <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3015 --><ul>
<li>
<strong>Checking for executable files</strong>. You must not have executable files in your package: they’re not portable, they’re not open source, and they are a security risk. Delete any executable files from your package. (If you’re not submitting to CRAN, you can silence this warning by listing each executable file in the <code>BinaryFiles</code> field in your <code>DESCRIPTION</code>.)</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3103 --><ul>
<li>
<strong>Checking for hidden files and directories</strong>. On Linux and macOS, files with a name starting with <code>.</code> are hidden by default, and you’ve probably included them in your package by mistake. Either delete them, or if they are important, use <code>.Rbuildignore</code> to remove them from the package bundle. R automatically removes some common directories like <code>.git</code> and <code>.svn</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L381 --><ul>
<li>
<strong>Checking for portable file names</strong>. R packages must work on Windows, Linux and macOS, so you can only use file names that work on all platforms. The easiest way to do this is to stick to letters, numbers, underscores and dashes. Avoid non-English letters and spaces. Fix this check by renaming the listed files.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L541 --><ul>
<li>
<strong>Checking for sufficient/correct file permissions</strong>. If you can’t read a file, you can’t check it. This check detects the unlikely occurrence that you have files in the package that you don’t have permission to read. Fix this problem by fixing the file permissions.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3141 --><ul>
<li>
<strong>Checking whether package ‘XYZ’ can be installed</strong>. <code>R CMD check</code> runs <code>R CMD INSTALL</code> to make sure that it’s possible to install your package. If this fails, you should run <code><a href="https://devtools.r-lib.org/reference/install.html">devtools::install()</a></code> or the equivalent from RStudio’s menus and debug any problems before continuing.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3459 --><ul>
<li>
<p><strong>Checking installed package size</strong>. It’s easy to accidentally include large files that blow up the size of your package. This check ensures that the whole package is less than 5 MB and each subdirectory is less than 1 MB. If you see this message, check that you haven’t accidentally included a large file.</p>
<p>If submitting to CRAN, you’ll need to justify the size of your package. First, make sure the package is as small as it possibly can be: try recompressing the data, <a href="data.html#sec-data-data-raw" class="quarto-xref"><span>Section 7.1.1</span></a>; and minimising vignettes, <a href="vignettes.html" class="quarto-xref"><span>Chapter 17</span></a>. If it’s still too large, consider moving data into its own package.</p>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L746 --><ul>
<li>
<p><strong>Checking top-level files</strong>. Only specified files and directories are allowed at the top level of the package (e.g.&nbsp;<code>DESCRIPTION</code>, <code>R/</code>, <code>src/</code>). To include other files, you have two choices:</p>
<ul>
<li><p>If they don’t need to be installed (i.e.&nbsp;they’re only used for development tasks), add them to <code>.Rbuildignore</code> with <code><a href="https://usethis.r-lib.org/reference/use_build_ignore.html">usethis::use_build_ignore()</a></code>.</p></li>
<li><p>If they need to be installed: move them into <code>inst/</code>. They’ll be moved back to the top-level package directory when installed. Learn more in <a href="misc.html#sec-misc-inst" class="quarto-xref"><span>Section 8.2</span></a>.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L924 --><ul>
<li>
<p><strong>Checking package subdirectories</strong>.</p>
<ul>
<li><p>Don’t include any empty directories. These are usually removed automatically by <code>R CMD build</code> so you shouldn’t see this error. If you do, just delete the empty directory.</p></li>
<li><p>The case of files and directories is important. All sub-directories should be lower-case, except for <code>R/</code>. A citation file, if present, should be in <code>inst/CITATION</code>. Rename as needed.</p></li>
<li><p>The contents of <code>inst/</code> shouldn’t clash with top-level contents of the package, such as <code>data/</code> or <code>R/</code>. If they do, rename your files/directories. Learn more in <a href="misc.html#sec-misc-inst" class="quarto-xref"><span>Section 8.2</span></a>.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L859 --><ul>
<li>
<strong>Checking for left-over files</strong>. Remove any files listed here. They’ve been included in your package by accident.</li>
</ul></section><section id="description" class="level2" data-number="A.3"><h2 data-number="A.3" class="anchored" data-anchor-id="description">
<span class="header-section-number">A.3</span> <code>DESCRIPTION</code>
</h2>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L597 -->
<ul>
<li>
<p><strong>Checking DESCRIPTION meta-information</strong>.</p>
<ul>
<li><p>The <code>DESCRIPTION</code> must be valid. You are unlikely to see this error, because <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code> runs the same check each time you re-load the package.</p></li>
<li><p>If you use any non-ASCII characters in the DESCRIPTION, you must also specify an encoding. There are only three encodings that work on all platforms: latin1, latin2 and UTF-8. We strongly recommend UTF-8: <code>Encoding: UTF-8</code>. Learn more in <a href="data.html#sec-data-non-ascii" class="quarto-xref"><span>Section 7.1.3</span></a>.</p></li>
<li><p>The <code>License</code> must refer to either a known license (a complete list can be found at <a href="https://svn.r-project.org/R/trunk/share/licenses/license.db" class="uri">https://svn.r-project.org/R/trunk/share/licenses/license.db</a>), or it must use <code>file LICENSE</code> and that file must exist. Errors here are most likely to be typos. Learn more in <a href="license.html" class="quarto-xref"><span>Chapter 12</span></a>.</p></li>
<li><p>You should either provide <code>Authors@R</code> or <code>Authors</code> and <code>Maintainer</code>. You’ll get an error if you’ve specified both, which you can fix by removing the one you didn’t want. Learn more in <a href="description.html#sec-description-authors-at-r" class="quarto-xref"><span>Section 9.3</span></a>.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3683
tools:::.check_package_depends --><ul>
<li>
<p><strong>Checking package dependencies</strong>.</p>
<ul>
<li><p>All packages listed in <code>Depends</code>, <code>Imports</code> and <code>LinkingTo</code> must be installed, and their version requirements must be met, otherwise your package can’t be checked.</p></li>
<li><p>Packages listed in <code>Suggests</code> must be installed, unless you’ve set the environment variable <code>_R_CHECK_FORCE_SUGGESTS_</code> to a false value (e.g.&nbsp;with <code>check(force_suggests = FALSE)</code>). This is useful if some of the suggested packages are not available on all platforms.</p></li>
<li><p>An easy way to install any missing or outdated dependencies is to run <code>devtools::install_deps(dependencies = TRUE)</code>. See also <code><a href="https://pak.r-lib.org/reference/local_install_deps.html">pak::local_install_deps()</a></code> and <code><a href="https://pak.r-lib.org/reference/local_install_dev_deps.html">pak::local_install_dev_deps()</a></code>.</p></li>
<li><p>R packages can not have a cycle of dependencies: i.e.&nbsp;if package A requires B, then B can not require A (otherwise which one would you load first?). If you see this error, you’ll need to rethink the design of your package. One easy fix is to move the conflicting package from <code>Imports</code> or <code>Depends</code> to <code>Suggests</code>.</p></li>
<li><p>Any packages used in the <code>NAMESPACE</code> must be listed in one of <code>Imports</code> (most commonly) or <code>Depends</code> (only in special cases).</p></li>
<li><p>Every package listed in <code>Depends</code> must also be imported in the <code>NAMESPACE</code> or accessed with <code>pkg::foo()</code>. If you don’t do this, your package will work when attached to the search path (with <code><a href="https://rdrr.io/r/base/library.html">library(mypackage)</a></code>) but will not work when only loaded (e.g.&nbsp;<code>mypackage::foo()</code>)</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3561 
tools:::.check_package_CRAN_incoming
--><ul>
<li>
<p><strong>Checking CRAN incoming feasibility</strong>. These checks only apply if you’re submitting to CRAN.</p>
<ul>
<li><p>If you’re submitting a new package, you can’t use the same name as an existing package. You’ll need to come up with a new name.</p></li>
<li><p>If you’re submitting an update, the version number must be higher than the current CRAN version. Update the <code>Version</code> field in <code>DESCRIPTION</code>.</p></li>
<li><p>If the maintainer of the package has changed (even if it’s just a change in email address), the new maintainer should submit to CRAN, and the old maintainer will receive an email prompting them to confirm the change.</p></li>
<li><p>You must use a standard open source license, as listed in <a href="https://svn.r-project.org/R/trunk/share/licenses/license.db" class="uri">https://svn.r-project.org/R/trunk/share/licenses/license.db</a>. You can not use a custom license as CRAN does not have the legal resources to review custom agreements.</p></li>
<li><p>The <code>Title</code> and <code>Description</code> must be free from spelling mistakes. The title of the package must be in title case. Neither title nor description should include either the name of your package or the word “package”. Reword your title and description as needed.</p></li>
<li><p>If you’re submitting a new package, you’ll always get a <code>NOTE</code>. This reminds the CRAN maintainers to do some extra manual checks.</p></li>
<li><p>Avoid submitting multiple versions of the same package in a short period of time. CRAN prefers at most one submission per month. If you need to fix a major bug, be apologetic.</p></li>
</ul>
</li>
</ul></section><section id="namespace" class="level2" data-number="A.4"><h2 data-number="A.4" class="anchored" data-anchor-id="namespace">
<span class="header-section-number">A.4</span> Namespace</h2>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L4433 -->
<ul>
<li>
<strong>Checking if there is a namespace</strong>. You must have a <code>NAMESPACE</code> file. This is handled for your automatically by the devtools workflow.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L3620 --><ul>
<li>
<strong>Checking package namespace information</strong>. The <code>NAMESPACE</code> should be parseable by <code><a href="https://rdrr.io/r/base/ns-internal.html">parseNamespaceFile()</a></code> and valid. If this check fails, it’s a bug in roxygen2.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2234 --><ul>
<li>
<strong>Checking whether the package can be loaded with stated dependencies</strong>. Runs <code><a href="https://rdrr.io/r/base/library.html">library(pkg)</a></code> with <code>R_DEFAULT_PACKAGES=NULL</code>, so the search path is empty (i.e.&nbsp;stats, graphics, grDevices, utils, datasets and methods are not attached like usual). Failure here typically indicates that you’re missing a dependency on one of those packages.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2264 --><ul>
<li>
<strong>Checking whether the namespace can be loaded with stated dependencies</strong>. Runs <code>loadNamespace(pkg)</code> with <code>R_DEFAULT_PACKAGES=NULL</code>. Failure usually indicates a problem with the namespace.</li>
</ul></section><section id="r-code" class="level2" data-number="A.5"><h2 data-number="A.5" class="anchored" data-anchor-id="r-code">
<span class="header-section-number">A.5</span> R code</h2>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1226 -->
<ul>
<li>
<strong>Checking R files for non-ASCII characters</strong>. For maximum portability (i.e.&nbsp;so people can use your package on Windows) you should avoid using non-ASCII characters in R files. It’s ok to use them in comments, but object names shouldn’t use them, and in strings you should use unicode escapes. See the CRAN-specific notes in <a href="code.html" class="quarto-xref"><span>Chapter 6</span></a> for more details.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1258 --><ul>
<li>
<strong>Checking R files for syntax errors</strong>. Obviously your R code must be valid. You’re unlikely to see this error if you’ve been regularly using <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code>.</li>
</ul>
<!--- tools:::.check_packages_used ---><ul>
<li>
<p><strong>Checking dependencies in R code</strong>. Errors here often indicate that you’ve forgotten to declare a needed package in the <code>DESCRIPTION</code>. Remember that you should never use <code><a href="https://rdrr.io/r/base/library.html">require()</a></code> or <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> inside a package - see <a href="description.html#sec-description-imports-suggests" class="quarto-xref"><span>Section 9.6</span></a>, <a href="dependencies-mindset-background.html" class="quarto-xref"><span>Chapter 10</span></a>, and <a href="dependencies-in-practice.html" class="quarto-xref"><span>Chapter 11</span></a> for more details on best practices.</p>
<p>Alternatively, you may have accidentally used <code>:::</code> to access an exported function from a package. Switch to <code>::</code> instead.</p>
</li>
</ul>
<!--- tools::checkS3methods ---><ul>
<li>
<p><strong>Checking S3 generic/method consistency</strong>. S3 methods must have a compatible function signature with their generic. This means that the method must have the same arguments as its generic, with one exception: if the generic includes <code>...</code> the method can have additional arguments.</p>
<p>A common cause of this error is defining print methods, because the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> generic contains<code>...</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BAD</span></span>
<span><span class="va">print.my_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hi"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># GOOD</span></span>
<span><span class="va">print.my_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hi"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also ok</span></span>
<span><span class="va">print.my_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">my_arg</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Hi"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ul>
<!-- tools::checkReplaceFuns --><ul>
<li>
<strong>Checking replacement functions</strong>. Replacement functions (e.g.&nbsp;functions that are called like <code>foo(x) &lt;- y</code>), must have <code>value</code> as the last argument.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1373
     tools:::.check_package_code_shlib
     tools:::.check_package_code_startup_functions
     tools:::.check_package_code_unload_functions
     tools:::.check_package_code_tampers
     tools:::.check_code_usage_in_package
     tools:::.check_dotInternal
     tools:::.check_package_code_assign_to_globalenv
     tools:::.check_package_code_attach
     tools:::.check_package_code_data_into_globalenv
     tools:::.check_depdef
     --><ul>
<li>
<p><strong>Checking R code for possible problems</strong>. This is a compound check for a wide range of problems:</p>
<ul>
<li><p>Calls to <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam()</a></code> (and <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam.unload()</a></code>) should look like <code>library.dynam("name")</code>, not <code>library.dynam("name.dll")</code>. Remove the extension to fix this error.</p></li>
<li><p>Put <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam()</a></code> in <code>.onLoad()</code>, not <code>.onAttach()</code>; put <code><a href="https://rdrr.io/r/base/message.html">packageStartupMessage()</a></code> in <code>.onAttach()</code>, not <code>.onLoad()</code>. Put <code><a href="https://rdrr.io/r/base/library.dynam.html">library.dynam.unload()</a></code> in <code>.onUnload()</code>. If you use any of these functions, make sure they’re in the right place.</p></li>
<li><p>Don’t use <code><a href="https://rdrr.io/r/base/bindenv.html">unlockBinding()</a></code> or <code><a href="https://rdrr.io/r/utils/getFromNamespace.html">assignInNamespace()</a></code> to modify objects that don’t belong to you.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/codetools/man/checkUsage.html">codetools::checkUsagePackage()</a></code> is called to check that your functions don’t use variables that don’t exist. This sometimes raises false positives with functions that use non-standard evaluation (NSE), like <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> or <code><a href="https://rdrr.io/r/base/with.html">with()</a></code>. Generally, we think you should avoid NSE in package functions, and hence avoid this NOTE, but if you can not, see <code><a href="https://rdrr.io/r/utils/globalVariables.html">?globalVariables</a></code> for how to suppress this NOTE.</p></li>
<li><p>You are not allowed to use <code><a href="https://rdrr.io/r/base/Internal.html">.Internal()</a></code> in a package. Either call the R wrapper function, or write your own C function. (If you copy and paste the C function from base R, make sure to maintain the copyright notice, use a GPL-2 compatible license, and list R-core in the <code>Authors@R</code> field.)</p></li>
<li><p>Similarly you are not allowed to use <code>:::</code> to access non-exported functions from other packages. Either ask the package maintainer to export the function you need, or write your own version of it using exported functions. Alternatively, if the licenses are compatible you can copy and paste the exported function into your own package. If you do this, remember to update <code>Authors@R</code>.</p></li>
<li><p>Don’t use <code><a href="https://rdrr.io/r/base/assign.html">assign()</a></code> to modify objects in the global environment. If you need to maintain state across function calls, create your own environment, as described in <a href="data.html#sec-data-state" class="quarto-xref"><span>Section 7.4</span></a>.</p></li>
<li><p>Don’t use <code><a href="https://rdrr.io/r/base/attach.html">attach()</a></code> in your code. Instead refer to variables explicitly.</p></li>
<li><p>Don’t use <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> without specifying the <code>envir</code> argument. Otherwise the data will be loaded in the global environment.</p></li>
<li><p>Don’t use deprecated or defunct functions. Update your code to use the latest versions.</p></li>
<li><p>You must use <code>TRUE</code> and <code>FALSE</code> in your code (and examples), not <code>T</code> and <code>F</code>.</p></li>
</ul>
</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2209 --><ul>
<li>
<strong>Checking whether the package can be loaded</strong>. R loads your package with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. Failure here typically indicates a problem with <code>.onLoad()</code> or <code>.onAttach()</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2247 --><ul>
<li>
<strong>Checking whether the package can be unloaded cleanly</strong>. Loads with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> and then <code><a href="https://rdrr.io/r/base/detach.html">detach()</a></code>es. If this fails, check <code>.onUnload()</code> and <code>.onDetach()</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2279 --><ul>
<li>
<strong>Checking whether the namespace can be unloaded cleanly</strong>. Runs <code>loadNamespace("pkg"); unloadNamespace("pkg")</code>. Check <code>.onUnload()</code> for problems.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2300 --><ul>
<li>
<strong>Checking loading without being on the library search path</strong>. Calls <code><a href="https://rdrr.io/r/base/library.html">library(x, lib.loc = ...)</a></code>. Failure here indicates that you are making a false assumption in <code>.onLoad()</code> or <code>.onAttach()</code>.</li>
</ul></section><section id="data" class="level2" data-number="A.6"><h2 data-number="A.6" class="anchored" data-anchor-id="data">
<span class="header-section-number">A.6</span> Data</h2>
<!-- 
https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1782 
tools:::.check_package_datasets
tools:::.check_package_compact_datasets
tools:::.check_package_compact_sysdata
-->
<ul>
<li>
<p><strong>Checking contents of ‘data’ directory</strong>.</p>
<ul>
<li><p>The data directory can only contain file types described in <a href="data.html#sec-data-data" class="quarto-xref"><span>Section 7.1</span></a>.</p></li>
<li><p>Data files can contain non-ASCII characters only if the encoding is correctly set. This usually shouldn’t be a problem if you’re saving <code>.Rdata</code> files. If you do see this error, look at the <code><a href="https://rdrr.io/r/base/Encoding.html">Encoding()</a></code> of each column in the data frame, and ensure none are “unknown”. (You’ll typically need to fix this somewhere in the import process). Learn more in <a href="data.html#sec-data-non-ascii" class="quarto-xref"><span>Section 7.1.3</span></a>.</p></li>
<li><p>If you’ve compressed a data file with <code>bzip2</code> or <code>xz</code> you need to declare at least <code>Depends: R (&gt;= 2.10)</code> in your <code>DESCRIPTION</code>.</p></li>
<li><p>If you’ve used a sub-optimal compression algorithm for your data, re-compress with the suggested algorithm.</p></li>
</ul>
</li>
</ul></section><section id="documentation" class="level2" data-number="A.7"><h2 data-number="A.7" class="anchored" data-anchor-id="documentation">
<span class="header-section-number">A.7</span> Documentation</h2>
<p>If you’re grappling with documentation problems specifically, you may be able to iterate more quickly by using <code><a href="https://devtools.r-lib.org/reference/check_man.html">devtools::check_man()</a></code>, which attempts to run only the relevant subset of checks. It also automatically calls <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> for you.</p>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1527 -->
<ul>
<li>
<strong>Checking Rd files</strong>. This checks that all <code>man/*.Rd</code> files use the correct Rd syntax. If this fails, it indicates a bug in roxygen2.</li>
</ul>
<!-- tools:::.check_Rd_metadata --><ul>
<li>
<strong>Checking Rd metadata</strong>. Names and aliases must be unique across all documentation files in a package. If you encounter this problem you’ve accidentally used the same <code>@name</code> or <code>@aliases</code> in multiple places; make sure they’re unique.</li>
</ul>
<!-- tools:::.check_Rd_line_widths --><ul>
<li>
<strong>Checking Rd line widths</strong>. Lines in Rd files must be less than 90 characters wide. This is unlikely to occur if you wrap your R code, and hence roxygen comments, to 80 characters. For very long URLs, use a link-shortening service like <a href="http://bit.ly">bit.ly</a>.</li>
</ul>
<!-- tools:::.check_Rd_xrefs --><ul>
<li>
<strong>Checking Rd cross-references</strong>. Errors here usually represent typos.</li>
</ul>
<!-- tools::undoc --><ul>
<li>
<strong>Checking for missing documentation entries</strong>. All exported objects must be documented. See <code><a href="https://rdrr.io/r/tools/undoc.html">?tools::undoc</a></code> for more details.</li>
</ul>
<!-- tools::codoc, tools::codocData, tools::codocClasses --><ul>
<li>
<strong>Checking for code/documentation mismatches</strong>. This check ensures that the documentation matches the code. This should never fail because you’re using roxygen2 which automatically keeps them in sync and <code>check()</code> should usually re-<code>document()</code> your package. In any case, the solution is often to re-run <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code>.</li>
</ul>
<!-- tools::checkDocFiles, tools::checkDocStyle --><ul>
<li>
<p><strong>Checking Rd <code>\usage</code> sections</strong>. All arguments must be documented, and all <code>@params</code> must document an existing argument. You may have forgotten to document an argument, forgotten to remove the documentation for an argument that you’ve removed, or misspelled an argument name.</p>
<p>S3 and S4 methods need to use special <code>\S3method{}</code> and <code>\S4method{}</code> markup in the Rd file. Roxygen2 will generate this for you automatically.</p>
</li>
</ul>
<!-- tools:::.check_Rd_contents --><ul>
<li>
<strong>Checking Rd contents</strong>. This checks for auto-generated content made by <code><a href="https://rdrr.io/r/utils/package.skeleton.html">package.skeleton()</a></code>. Since you’re not using <code><a href="https://rdrr.io/r/utils/package.skeleton.html">package.skeleton()</a></code> you should never have a problem here.</li>
</ul>
<!-- tools:::.check_packages_used_in_examples --><ul>
<li>
<strong>Checking for unstated dependencies in examples</strong>. If you use a package only for an example, make sure it’s listed in the <code>Suggests</code> field. Learn more about how to use different types of dependencies in your examples in <a href="dependencies-in-practice.html" class="quarto-xref"><span>Chapter 11</span></a>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2317 --><ul>
<li>
<strong>Checking examples</strong>. Every documentation example must run without errors, and must not take too long. See <a href="man.html#sec-man-examples" class="quarto-xref"><span>Section 16.5</span></a> for details.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2925 --><ul>
<li>
<strong>Checking PDF version of manual</strong>. Occasionally you’ll get an error when building the PDF manual. This is usually because the pdf is built by latex and you’ve forgotten to escape something. Debugging this is painful - your best bet is to look up the latex logs and combined tex file and work back from there to <code>.Rd</code> files then back to a roxygen comment. Any such failure is potentially a bug in roxygen2, so open an issue.</li>
</ul></section><section id="demos" class="level2" data-number="A.8"><h2 data-number="A.8" class="anchored" data-anchor-id="demos">
<span class="header-section-number">A.8</span> Demos</h2>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L877 -->
<ul>
<li>
<p><strong>Checking index information</strong>. If you’ve written demos, each demo must be listed in <code>demo/00Index</code>. The file should look like:</p>
<pre><code>demo-name-without-extension  Demo description
another-demo-name            Another description</code></pre>
</li>
</ul></section><section id="compiled-code" class="level2" data-number="A.9"><h2 data-number="A.9" class="anchored" data-anchor-id="compiled-code">
<span class="header-section-number">A.9</span> Compiled code</h2>
<!-- tools::checkFF -->
<ul>
<li>
<strong>Checking foreign function calls</strong>. <code><a href="https://rdrr.io/r/base/CallExternal.html">.Call()</a></code>, <code><a href="https://rdrr.io/r/base/Foreign.html">.C()</a></code>, <code><a href="https://rdrr.io/r/base/Foreign.html">.Fortran()</a></code>, <code><a href="https://rdrr.io/r/base/CallExternal.html">.External()</a></code> must always be called either with a <code>NativeSymbolInfo</code> object (as created with <code>@useDynLib</code>) or use the <code>.package</code> argument. See <code><a href="https://rdrr.io/r/tools/checkFF.html">?tools::checkFF</a></code> for more details.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2065 --><ul>
<li>
<strong>Checking line endings in C/C++/Fortran sources/headers</strong>. Always use LF as a line ending.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2084 --><ul>
<li>
<strong>Checking line endings in Makefiles</strong>. As above.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2120 --><ul>
<li>
<strong>Checking for portable use of <code>$(BLAS_LIBS)</code> and <code>$(LAPACK_LIBS)</code></strong>. Errors here indicate an issue with your use of BLAS and LAPACK.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2159 
 tools:::check_compiled_code
 --><ul>
<li>
<strong>Checking compiled code</strong>. Checks that you’re not using any C functions that you shouldn’t.</li>
</ul></section><section id="tests" class="level2" data-number="A.10"><h2 data-number="A.10" class="anchored" data-anchor-id="tests">
<span class="header-section-number">A.10</span> Tests</h2>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2514 -->
<ul>
<li>
<strong>Checking for unstated dependencies in tests</strong>. Every package used by tests must be included in the dependencies.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2526 --><ul>
<li>
<p><strong>Checking tests</strong>. Each file in <code>tests/</code> is run. If you’ve followed the instructions in <a href="testing-basics.html" class="quarto-xref"><span>Chapter 13</span></a> you’ll have at least one file: <code>testthat.R</code>. The output from <code>R CMD check</code> is not usually that helpful, so you may need to look at the log file <code>package.Rcheck/tests/testthat.Rout</code>. Fix any failing tests by iterating with <code><a href="https://devtools.r-lib.org/reference/test.html">devtools::test()</a></code>.</p>
<p>Occasionally you may have a problem where the tests pass when run interactively with <code><a href="https://devtools.r-lib.org/reference/test.html">devtools::test()</a></code>, but fail when in <code>R CMD check</code>. This usually indicates that you’ve made a faulty assumption about the testing environment, and it’s often hard to figure it out.</p>
</li>
</ul></section><section id="vignettes" class="level2" data-number="A.11"><h2 data-number="A.11" class="anchored" data-anchor-id="vignettes">
<span class="header-section-number">A.11</span> Vignettes</h2>
<p>This is a tricky enough topic that it also receives substantial coverage in the main body of the book; see <a href="vignettes.html#sec-vignettes-how-built-checked" class="quarto-xref"><span>Section 17.5</span></a>.</p>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L718 -->
<ul>
<li>
<strong>Checking ‘build’ directory</strong>. <code>build/</code> is used to track vignette builds. It’s hard to imagine how this check could fail unless you’ve accidentally <code>.Rbuildignore</code>d the <code>build/</code> directory.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1846 --><ul>
<li>
<strong>Checking installed files from ‘inst/doc’</strong>. Don’t put files in <code>inst/doc</code> - keep your vignettes and the files they need in <code>vignettes/</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L1941 --><ul>
<li>
<strong>Checking files in ‘vignettes’</strong>. Problems here are usually straightforward - you’ve included files that are already included in R (like <code>jss.cls</code>, <code>jss.bst</code>, or <code>Sweave.sty</code>), or you have leftover latex compilation files. Delete these files.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2008 --><ul>
<li>
<strong>Checking for sizes of PDF files under ‘inst/doc’</strong>. If you’re making PDF vignettes, you can make them as small as possible by running <code><a href="https://rdrr.io/r/tools/compactPDF.html">tools::compactPDF()</a></code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2619 --><ul>
<li>
<strong>Checking for unstated dependencies in vignettes</strong>. As with tests, every package that you use in a vignette must be listed in the <code>DESCRIPTION</code>. If a package is used only for a vignette, and not elsewhere, make sure it’s listed in <code>Suggests</code>. If you really want to use a package and you don’t want to list it in <code>DESCRIPTION</code>, write an article instead of a vignette.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2629 --><ul>
<li>
<strong>Checking package vignettes in ‘inst/doc’</strong>. This checks that every source vignette (i.e.&nbsp;<code>.Rmd</code>) has a built equivalent (i.e.&nbsp;<code>.html</code>) in <code>inst/doc</code>. This shouldn’t fail if you’ve used the standard process outlined in <a href="vignettes.html" class="quarto-xref"><span>Chapter 17</span></a>. If there is a problem, start by checking your <code>.Rbuildignore</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2763 --><ul>
<li>
<strong>Checking running R code from vignettes</strong>. The R code from each vignette is run. If you want to deliberately execute errors (to show the user what failure looks like), make sure the chunk has <code>error = TRUE, purl = FALSE</code>.</li>
</ul>
<!-- https://github.com/wch/r-source/blob/trunk/src/library/tools/R/check.R#L2856 --><ul>
<li>
<strong>Checking re-building of vignette outputs</strong>. Each vignette is re-knit to make sure that the output corresponds to the input. Again, this shouldn’t fail in normal circumstances.</li>
</ul></section><section id="sec-r-cmd-check-informational-notes" class="level2" data-number="A.12"><h2 data-number="A.12" class="anchored" data-anchor-id="sec-r-cmd-check-informational-notes">
<span class="header-section-number">A.12</span> NOTEs that are informational</h2>
<p>Our blanket advice is to eliminate all ERRORs, WARNINGs, and even NOTEs that you see in <code>R CMD check</code>. But there are a few exceptions, i.e.&nbsp;there are a couple of NOTEs that do you not need to fix (and, indeed, probably can not fix).</p>
<section id="initial-cran-submission" class="level3" data-number="A.12.1"><h3 data-number="A.12.1" class="anchored" data-anchor-id="initial-cran-submission">
<span class="header-section-number">A.12.1</span> Initial CRAN submission</h3>
<p>When a package first goes to CRAN, there will always be one NOTE that alerts the CRAN maintainers that this is a new submission and that they’ll need to do some extra checks. You can’t eliminate this NOTE.</p>
<pre><code>* checking CRAN incoming feasibility ... NOTE
Maintainer: 'Jane Doe &lt;jane@example.com&gt;'

New submission</code></pre>
</section><section id="non-ascii-characters-in-data" class="level3" data-number="A.12.2"><h3 data-number="A.12.2" class="anchored" data-anchor-id="non-ascii-characters-in-data">
<span class="header-section-number">A.12.2</span> Non-ASCII characters in data</h3>
<p>If your package’s data contains non-ASCII characters, you will get a NOTE like this, but it does not necessarily mean you need to do anything about it.</p>
<pre><code>Check: data for non-ASCII characters
Result: NOTE
     Note: found 25 marked UTF-8 strings</code></pre>
<p>As long as you are aware of the non-ASCII characters and the NOTE mentions your intended and declared encoding (preferably UTF-8), all is well.</p>
</section><section id="rd-cross-references" class="level3" data-number="A.12.3"><h3 data-number="A.12.3" class="anchored" data-anchor-id="rd-cross-references">
<span class="header-section-number">A.12.3</span> Rd cross-references</h3>
<p>If your roxygen comments contain a cross-reference to a package that is not a formal, direct dependency, you might see a NOTE like this:</p>
<pre><code>Check: Rd cross-references
Result: NOTE
    Undeclared package ‘jsonlite’ in Rd xrefs</code></pre>
<p>This could happen if you want to document something related to a hard indirect dependency: There’s a legitimate reason to link to a topic in the other package and it is basically guaranteed to be installed. Therefore, in practice, often more good than harm comes from the cross-reference.</p>
<p>In our experience, this NOTE is only seen on certain CRAN check flavors and not others. Thus far, we have never been directed to address this NOTE by CRAN maintainers.</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/r-pkgs\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hadley/r-pkgs/edit/main/R-CMD-check.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>